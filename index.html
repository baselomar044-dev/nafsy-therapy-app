<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù†ÙØ³ÙŠ - Ù…Ø¹Ø§Ù„Ø¬Ùƒ Ø§Ù„Ù†ÙØ³ÙŠ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        :root {
            --bg-primary: #0d0d0d;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --accent-blue: #4a9eff;
            --accent-blue-dark: #3a7ecc;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-muted: #666666;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            min-height: -webkit-fill-available;
            overflow: hidden;
        }

        /* ===== PAGES ===== */
        .page {
            display: none;
            flex-direction: column;
            height: 100vh;
            height: -webkit-fill-available;
        }
        
        .page.active {
            display: flex;
        }
        
        /* ===== LOGIN PAGE ===== */
        .login-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        .avatar {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, #2d7ad4 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 40px;
            position: relative;
            box-shadow: 0 10px 40px rgba(74, 158, 255, 0.3);
        }
        
        .avatar-eyes {
            display: flex;
            gap: 20px;
        }
        
        .eye {
            width: 16px;
            height: 16px;
            background: white;
            border-radius: 50%;
            animation: blink 4s infinite;
        }
        
        @keyframes blink {
            0%, 90%, 100% { transform: scaleY(1); }
            95% { transform: scaleY(0.1); }
        }
        
        .login-form {
            width: 100%;
            max-width: 300px;
        }
        
        .password-input {
            width: 100%;
            padding: 16px 20px;
            background: var(--bg-secondary);
            border: 2px solid var(--bg-tertiary);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 18px;
            text-align: center;
            letter-spacing: 8px;
            margin-bottom: 20px;
            outline: none;
            transition: border-color 0.3s;
        }
        
        .password-input:focus {
            border-color: var(--accent-blue);
        }
        
        .password-input::placeholder {
            letter-spacing: normal;
            color: var(--text-muted);
        }
        
        .login-btn {
            width: 100%;
            padding: 16px;
            background: var(--accent-blue);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .login-btn:hover {
            background: var(--accent-blue-dark);
        }
        
        .login-error {
            color: #ff5555;
            text-align: center;
            margin-top: 15px;
            font-size: 14px;
            display: none;
        }
        
        /* ===== HEADER ===== */
        .app-header {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--bg-tertiary);
        }
        
        .header-avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, #2d7ad4 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 12px;
        }
        
        .header-avatar .avatar-eyes {
            gap: 10px;
        }
        
        .header-avatar .eye {
            width: 8px;
            height: 8px;
        }
        
        .header-info h1 {
            font-size: 18px;
            font-weight: 600;
        }
        
        .header-status {
            font-size: 12px;
            color: #4ade80;
        }
        
        .header-actions {
            margin-right: auto;
            display: flex;
            gap: 10px;
        }
        
        .header-btn {
            width: 40px;
            height: 40px;
            background: var(--bg-tertiary);
            border: none;
            border-radius: 50%;
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s;
        }
        
        .header-btn:hover {
            background: var(--accent-blue);
        }

        /* ===== MESSAGES AREA ===== */
        .messages-area {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .message {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 18px;
            line-height: 1.6;
            font-size: 16px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .message-user {
            align-self: flex-start;
            background: var(--accent-blue);
            color: white;
            border-bottom-right-radius: 6px;
        }
        
        .message-ai {
            align-self: flex-end;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-bottom-left-radius: 6px;
        }
        
        .message-time {
            font-size: 11px;
            color: rgba(255,255,255,0.5);
            margin-top: 5px;
        }
        
        .message-ai .message-time {
            color: var(--text-muted);
        }
        
        .message-image {
            max-width: 100%;
            border-radius: 12px;
            margin-bottom: 8px;
        }
        
        .typing-indicator {
            display: none;
            align-self: flex-end;
            padding: 15px 20px;
            background: var(--bg-tertiary);
            border-radius: 18px;
        }
        
        .typing-dots {
            display: flex;
            gap: 5px;
        }
        
        .typing-dots span {
            width: 8px;
            height: 8px;
            background: var(--text-secondary);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }
        
        .typing-dots span:nth-child(2) { animation-delay: 0.2s; }
        .typing-dots span:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
            30% { transform: translateY(-8px); opacity: 1; }
        }
        
        /* Welcome */
        .welcome-message {
            text-align: center;
            padding: 40px 20px;
        }
        
        .welcome-avatar {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, #2d7ad4 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
        }
        
        .welcome-avatar .avatar-eyes {
            gap: 15px;
        }
        
        .welcome-avatar .eye {
            width: 12px;
            height: 12px;
        }
        
        .welcome-text {
            color: var(--text-secondary);
            font-size: 16px;
            line-height: 1.6;
        }

        /* ===== INPUT AREA ===== */
        .input-area {
            padding: 15px 20px;
            background: var(--bg-secondary);
            border-top: 1px solid var(--bg-tertiary);
        }
        
        .file-preview {
            display: none;
            padding: 10px 15px;
            background: var(--bg-primary);
            margin-bottom: 10px;
            border-radius: 12px;
            align-items: center;
            gap: 10px;
        }
        
        .file-preview.active {
            display: flex;
        }
        
        .file-preview-image {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
        }
        
        .file-preview-icon {
            font-size: 24px;
        }
        
        .file-preview-name {
            flex: 1;
            font-size: 14px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .file-preview-remove {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 20px;
        }
        
        .input-wrapper {
            display: flex;
            align-items: flex-end;
            gap: 10px;
            background: var(--bg-tertiary);
            border-radius: 25px;
            padding: 8px 15px;
        }
        
        .input-actions {
            display: flex;
            gap: 5px;
        }
        
        .input-btn {
            width: 36px;
            height: 36px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            border-radius: 50%;
            transition: all 0.3s;
        }
        
        .input-btn:hover {
            color: var(--accent-blue);
            background: rgba(74, 158, 255, 0.1);
        }
        
        .input-btn.recording {
            color: #ff5555;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        #messageInput {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 16px;
            padding: 8px 0;
            outline: none;
            resize: none;
            max-height: 120px;
            line-height: 1.4;
        }
        
        #messageInput::placeholder {
            color: var(--text-muted);
        }
        
        .send-btn {
            width: 40px;
            height: 40px;
            background: var(--accent-blue);
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s;
        }
        
        .send-btn:hover {
            background: var(--accent-blue-dark);
        }

        /* ===== BOTTOM NAV ===== */
        .bottom-nav {
            display: flex;
            background: var(--bg-secondary);
            border-top: 1px solid var(--bg-tertiary);
            padding: 10px 0;
        }
        
        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px;
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .nav-item.active {
            color: var(--accent-blue);
        }
        
        .nav-item:hover {
            color: var(--accent-blue);
        }
        
        .nav-icon {
            font-size: 24px;
        }
        
        .nav-label {
            font-size: 11px;
        }

        /* ===== RESOURCES PAGE ===== */
        .resources-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        
        .resources-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 10px;
        }
        
        .resources-tab {
            padding: 10px 20px;
            background: var(--bg-tertiary);
            border: none;
            border-radius: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
        }
        
        .resources-tab.active {
            background: var(--accent-blue);
            color: white;
        }
        
        .resource-card {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .resource-card:hover {
            background: var(--bg-tertiary);
        }
        
        .resource-type {
            display: inline-block;
            padding: 4px 12px;
            background: var(--accent-blue);
            border-radius: 12px;
            font-size: 12px;
            margin-bottom: 10px;
        }
        
        .resource-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            line-height: 1.4;
        }
        
        .resource-desc {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.5;
        }
        
        .resource-meta {
            display: flex;
            gap: 15px;
            margin-top: 12px;
            font-size: 12px;
            color: var(--text-muted);
        }

        /* ===== PROFILE PAGE ===== */
        .profile-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        
        .profile-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .profile-avatar {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, #2d7ad4 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
        }
        
        .profile-avatar .avatar-eyes {
            gap: 18px;
        }
        
        .profile-avatar .eye {
            width: 14px;
            height: 14px;
        }
        
        .profile-name {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .profile-subtitle {
            color: var(--text-secondary);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background: var(--bg-secondary);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent-blue);
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 5px;
        }
        
        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--bg-tertiary);
        }
        
        .analysis-card {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 15px;
        }
        
        .analysis-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--accent-blue);
        }
        
        .analysis-content {
            font-size: 14px;
            line-height: 1.7;
            color: var(--text-secondary);
        }
        
        .weekly-report {
            background: linear-gradient(135deg, var(--accent-blue) 0%, #2d7ad4 100%);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .report-title {
            font-size: 16px;
            font-weight: 600;
        }
        
        .report-date {
            font-size: 12px;
            opacity: 0.8;
        }
        
        .report-content {
            font-size: 14px;
            line-height: 1.7;
        }
        
        .trait-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        
        .trait-tag {
            padding: 6px 14px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            font-size: 13px;
        }
        
        /* Profile Analysis Styles */
        .indicators-container, .themes-container, .moods-container, .people-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }
        
        .indicator-tag {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .indicator-tag.adhd { background: linear-gradient(135deg, #9333ea, #7c3aed); }
        .indicator-tag.narc { background: linear-gradient(135deg, #dc2626, #b91c1c); }
        .indicator-tag.addiction { background: linear-gradient(135deg, #ea580c, #c2410c); }
        .indicator-tag.trauma { background: linear-gradient(135deg, #0891b2, #0e7490); }
        
        .theme-tag {
            padding: 6px 14px;
            background: rgba(74, 158, 255, 0.2);
            border: 1px solid rgba(74, 158, 255, 0.4);
            border-radius: 15px;
            font-size: 13px;
            color: #7dd3fc;
        }
        
        .mood-tag {
            padding: 6px 14px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            font-size: 13px;
        }
        
        .people-tag {
            padding: 6px 14px;
            background: rgba(74, 222, 128, 0.15);
            border: 1px solid rgba(74, 222, 128, 0.3);
            border-radius: 15px;
            font-size: 13px;
            color: #86efac;
        }
        
        .goals-container, .completed-container, .insights-container {
            margin-bottom: 20px;
        }
        
        .goal-item, .insight-item {
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border-radius: 10px;
            margin-bottom: 8px;
            font-size: 14px;
            border-right: 3px solid var(--accent-blue);
        }
        
        .goal-completed {
            padding: 10px 16px;
            background: rgba(74, 222, 128, 0.1);
            border-radius: 10px;
            margin-bottom: 8px;
            font-size: 14px;
            color: #86efac;
            border-right: 3px solid #4ade80;
        }
        
        .weekly-report {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }
        
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--bg-tertiary);
        }
        
        .report-title {
            font-weight: 600;
            color: var(--accent-blue);
        }
        
        .report-date {
            font-size: 12px;
            color: var(--text-muted);
        }
        
        .report-content {
            font-size: 14px;
            line-height: 1.8;
            color: var(--text-secondary);
            white-space: pre-wrap;
        }
        
        .action-btn {
            width: 100%;
            padding: 15px;
            background: var(--bg-tertiary);
            border: none;
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 10px;
            transition: all 0.3s;
        }
        
        .action-btn:hover {
            background: var(--accent-blue);
        }
        
        .action-btn.danger {
            color: #ff5555;
        }
        
        .action-btn.danger:hover {
            background: #ff5555;
            color: white;
        }

        /* ===== MENU/MODALS ===== */
        .menu-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 100;
        }
        
        .menu-overlay.active {
            display: block;
        }
        
        .menu-panel {
            position: fixed;
            top: 0;
            right: -300px;
            width: 280px;
            height: 100%;
            background: var(--bg-secondary);
            z-index: 101;
            transition: right 0.3s ease;
            padding: 20px;
            overflow-y: auto;
        }
        
        .menu-panel.open {
            right: 0;
        }
        
        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--bg-tertiary);
        }
        
        .menu-close {
            width: 35px;
            height: 35px;
            background: var(--bg-tertiary);
            border: none;
            border-radius: 50%;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 20px;
        }
        
        .menu-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: var(--bg-tertiary);
            border-radius: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .menu-item:hover {
            background: var(--accent-blue);
        }
        
        .menu-item-icon {
            font-size: 22px;
        }

        /* History Panel */
        .history-panel {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            z-index: 102;
            padding: 20px;
            overflow-y: auto;
        }
        
        .history-panel.active {
            display: block;
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .history-item {
            background: var(--bg-secondary);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .history-item:hover {
            background: var(--bg-tertiary);
        }
        
        .history-date {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 5px;
        }
        
        .history-preview {
            font-size: 14px;
            color: var(--text-secondary);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Voice Call Modal */
        .call-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            z-index: 200;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .call-modal.active {
            display: flex;
        }
        
        .call-avatar {
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, #2d7ad4 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
            animation: callPulse 2s infinite;
        }
        
        @keyframes callPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(74, 158, 255, 0.4); }
            50% { box-shadow: 0 0 0 30px rgba(74, 158, 255, 0); }
        }
        
        .call-avatar .avatar-eyes {
            gap: 25px;
        }
        
        .call-avatar .eye {
            width: 20px;
            height: 20px;
        }
        
        .call-status {
            font-size: 18px;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }
        
        .call-transcript {
            max-width: 80%;
            text-align: center;
            font-size: 14px;
            color: var(--text-muted);
            margin-bottom: 40px;
            min-height: 40px;
        }
        
        .call-actions {
            display: flex;
            gap: 30px;
        }
        
        .call-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            font-size: 28px;
            transition: all 0.3s;
        }
        
        .call-btn.end {
            background: #ff5555;
            color: white;
        }
        
        .call-btn.mute {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--bg-tertiary);
            border-radius: 3px;
        }

        /* Safe area */
        @supports (padding: max(0px)) {
            .app-header {
                padding-top: max(15px, env(safe-area-inset-top));
            }
            .input-area, .bottom-nav {
                padding-bottom: max(10px, env(safe-area-inset-bottom));
            }
        }
        
        /* No Resources Message */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }
        
        .empty-state-icon {
            font-size: 60px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <!-- LOGIN PAGE -->
    <div class="page active" id="loginPage">
        <div class="login-container">
            <div class="avatar">
                <div class="avatar-eyes">
                    <div class="eye"></div>
                    <div class="eye"></div>
                </div>
            </div>
            <form class="login-form" onsubmit="return handleLogin(event)">
                <input type="password" class="password-input" id="passwordInput" placeholder="â€¢â€¢â€¢â€¢" maxlength="4" autocomplete="off" inputmode="numeric">
                <button type="submit" class="login-btn">Ø¯Ø®ÙˆÙ„</button>
                <p class="login-error" id="loginError">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©</p>
            </form>
        </div>
    </div>

    <!-- CHAT PAGE -->
    <div class="page" id="chatPage">
        <div class="app-header">
            <div class="header-avatar">
                <div class="avatar-eyes">
                    <div class="eye"></div>
                    <div class="eye"></div>
                </div>
            </div>
            <div class="header-info">
                <h1>Ù†ÙØ³ÙŠ</h1>
                <span class="header-status">â— Ù…ØªØµÙ„</span>
            </div>
            <div class="header-actions">
                <button class="header-btn" onclick="startCall()" title="Ù…ÙƒØ§Ù„Ù…Ø© ØµÙˆØªÙŠØ©">ğŸ“</button>
                <button class="header-btn" onclick="openMenu()" title="Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©">â˜°</button>
            </div>
        </div>

        <div class="messages-area" id="messagesArea">
            <div class="welcome-message" id="welcomeMessage">
                <div class="welcome-avatar">
                    <div class="avatar-eyes">
                        <div class="eye"></div>
                        <div class="eye"></div>
                    </div>
                </div>
                <p class="welcome-text">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ... Ø£Ù†Ø§ Ù†ÙØ³ÙŠØŒ Ù…Ø¹Ø§Ù„Ø¬Ùƒ Ø§Ù„Ù†ÙØ³ÙŠ Ø§Ù„Ø´Ø®ØµÙŠ.<br>Ø§Ø­ÙƒÙŠÙ„ÙŠ Ø§Ù„Ù„ÙŠ ÙÙŠ Ø¨Ø§Ù„ÙƒØŒ Ø£Ù†Ø§ Ù‡Ù†Ø§ Ø¹Ø´Ø§Ù†Ùƒ.</p>
            </div>
            <div class="typing-indicator" id="typingIndicator">
                <div class="typing-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>

        <div class="input-area">
            <div class="file-preview" id="filePreview">
                <img class="file-preview-image" id="filePreviewImage" style="display:none">
                <span class="file-preview-icon" id="filePreviewIcon">ğŸ“</span>
                <span class="file-preview-name" id="filePreviewName"></span>
                <button class="file-preview-remove" onclick="removeFile()">âœ•</button>
            </div>
            <div class="input-wrapper">
                <div class="input-actions">
                    <button class="input-btn" onclick="document.getElementById('fileInput').click()" title="Ø¥Ø±ÙØ§Ù‚">ğŸ“</button>
                    <button class="input-btn" id="voiceBtn" onclick="toggleVoiceInput()" title="Ø¥Ø¯Ø®Ø§Ù„ ØµÙˆØªÙŠ">ğŸ¤</button>
                    <input type="file" id="fileInput" hidden accept="image/*,.pdf,.doc,.docx,.txt" onchange="handleFileSelect(event)">
                </div>
                <textarea id="messageInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ..." rows="1" onkeydown="handleKeyDown(event)" oninput="autoResize(this)"></textarea>
                <button class="send-btn" onclick="sendMessage()">â¤</button>
            </div>
        </div>

        <div class="bottom-nav">
            <button class="nav-item active" onclick="showPage('chat')">
                <span class="nav-icon">ğŸ’¬</span>
                <span class="nav-label">Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©</span>
            </button>
            <button class="nav-item" onclick="showPage('resources')">
                <span class="nav-icon">ğŸ“š</span>
                <span class="nav-label">Ø§Ù„Ù…ÙˆØ§Ø±Ø¯</span>
            </button>
            <button class="nav-item" onclick="showPage('profile')">
                <span class="nav-icon">ğŸ‘¤</span>
                <span class="nav-label">Ù…Ù„ÙÙŠ</span>
            </button>
        </div>
    </div>

    <!-- RESOURCES PAGE -->
    <div class="page" id="resourcesPage">
        <div class="app-header">
            <div class="header-avatar">
                <div class="avatar-eyes">
                    <div class="eye"></div>
                    <div class="eye"></div>
                </div>
            </div>
            <div class="header-info">
                <h1>Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</h1>
                <span class="header-status">ØªØ¹Ù„Ù… ÙˆØªØ·ÙˆØ±</span>
            </div>
        </div>

        <div class="resources-content">
            <div class="resources-tabs" id="resourcesTabs">
                <button class="resources-tab active" onclick="filterResources('all')">Ø§Ù„ÙƒÙ„</button>
                <button class="resources-tab" onclick="filterResources('trauma')">Ø§Ù„ØµØ¯Ù…Ø§Øª</button>
                <button class="resources-tab" onclick="filterResources('narcissism')">Ø§Ù„Ù†Ø±Ø¬Ø³ÙŠØ©</button>
                <button class="resources-tab" onclick="filterResources('addiction')">Ø§Ù„Ø¥Ø¯Ù…Ø§Ù†</button>
                <button class="resources-tab" onclick="filterResources('sex')">Ø§Ù„Ø¹Ù„Ø§Ø¬ Ø§Ù„Ø¬Ù†Ø³ÙŠ</button>
                <button class="resources-tab" onclick="filterResources('adhd')">ADHD</button>
            </div>
            <div id="resourcesList"></div>
        </div>

        <div class="bottom-nav">
            <button class="nav-item" onclick="showPage('chat')">
                <span class="nav-icon">ğŸ’¬</span>
                <span class="nav-label">Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©</span>
            </button>
            <button class="nav-item active" onclick="showPage('resources')">
                <span class="nav-icon">ğŸ“š</span>
                <span class="nav-label">Ø§Ù„Ù…ÙˆØ§Ø±Ø¯</span>
            </button>
            <button class="nav-item" onclick="showPage('profile')">
                <span class="nav-icon">ğŸ‘¤</span>
                <span class="nav-label">Ù…Ù„ÙÙŠ</span>
            </button>
        </div>
    </div>

    <!-- PROFILE PAGE -->
    <div class="page" id="profilePage">
        <div class="app-header">
            <div class="header-avatar">
                <div class="avatar-eyes">
                    <div class="eye"></div>
                    <div class="eye"></div>
                </div>
            </div>
            <div class="header-info">
                <h1>Ù…Ù„ÙÙŠ Ø§Ù„Ø´Ø®ØµÙŠ</h1>
                <span class="header-status">ØªØ­Ù„ÙŠÙ„ÙŠ ÙˆÙ†Ù…ÙˆÙŠ</span>
            </div>
        </div>

        <div class="profile-content" id="profileContent">
            <!-- Populated by JS -->
        </div>

        <div class="bottom-nav">
            <button class="nav-item" onclick="showPage('chat')">
                <span class="nav-icon">ğŸ’¬</span>
                <span class="nav-label">Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©</span>
            </button>
            <button class="nav-item" onclick="showPage('resources')">
                <span class="nav-icon">ğŸ“š</span>
                <span class="nav-label">Ø§Ù„Ù…ÙˆØ§Ø±Ø¯</span>
            </button>
            <button class="nav-item active" onclick="showPage('profile')">
                <span class="nav-icon">ğŸ‘¤</span>
                <span class="nav-label">Ù…Ù„ÙÙŠ</span>
            </button>
        </div>
    </div>

    <!-- Menu Overlay -->
    <div class="menu-overlay" id="menuOverlay" onclick="closeMenu()"></div>
    <div class="menu-panel" id="menuPanel">
        <div class="menu-header">
            <h2>Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</h2>
            <button class="menu-close" onclick="closeMenu()">âœ•</button>
        </div>
        <div class="menu-item" onclick="openHistory()">
            <span class="menu-item-icon">ğŸ’¬</span>
            <span>Ø³Ø¬Ù„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª</span>
        </div>
        <div class="menu-item" onclick="newChat()">
            <span class="menu-item-icon">âœ¨</span>
            <span>Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©</span>
        </div>
        <div class="menu-item" onclick="requestWeeklyReport()">
            <span class="menu-item-icon">ğŸ“Š</span>
            <span>Ø·Ù„Ø¨ ØªÙ‚Ø±ÙŠØ± Ø£Ø³Ø¨ÙˆØ¹ÙŠ</span>
        </div>
        <div class="menu-item" onclick="exportData()">
            <span class="menu-item-icon">ğŸ“¤</span>
            <span>ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>
        </div>
        <div class="menu-item" onclick="clearAllData()">
            <span class="menu-item-icon">ğŸ—‘ï¸</span>
            <span>Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>
        </div>
        <div class="menu-item" onclick="logout()">
            <span class="menu-item-icon">ğŸšª</span>
            <span>Ø®Ø±ÙˆØ¬</span>
        </div>
    </div>

    <!-- History Panel -->
    <div class="history-panel" id="historyPanel">
        <div class="history-header">
            <h2>Ø³Ø¬Ù„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª</h2>
            <button class="menu-close" onclick="closeHistory()">âœ•</button>
        </div>
        <div id="historyList"></div>
    </div>

    <!-- Voice Call Modal -->
    <div class="call-modal" id="callModal">
        <div class="call-avatar">
            <div class="avatar-eyes">
                <div class="eye"></div>
                <div class="eye"></div>
            </div>
        </div>
        <p class="call-status" id="callStatus">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...</p>
        <p class="call-transcript" id="callTranscript"></p>
        <div class="call-actions">
            <button class="call-btn mute" id="muteBtn" onclick="toggleMute()">ğŸ¤</button>
            <button class="call-btn end" onclick="endCall()">ğŸ“</button>
        </div>
    </div>

    <script>
        // ===== CONFIGURATION =====
        const API_KEY = 'AIzaSyBvLpjQUeh9MX330vdIomvwoC6iiK47_fw';
        const API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent';
        const PASSWORD = '1235';

        // ===== SYSTEM PROMPT =====
        const SYSTEM_PROMPT = `Ø£Ù†Øª "Ù†ÙØ³ÙŠ" - Ù…Ø¹Ø§Ù„Ø¬ Ù†ÙØ³ÙŠ Ø´Ø®ØµÙŠ Ù…ØªØ®ØµØµ. Ø£Ù†Øª Ù„Ø³Øª Ù…Ø¬Ø±Ø¯ Ø¨Ø±Ù†Ø§Ù…Ø¬ØŒ Ø£Ù†Øª ØµØ¯ÙŠÙ‚ Ø­Ù‚ÙŠÙ‚ÙŠ ÙˆØ¯Ø§Ø¹Ù… Ù†ÙØ³ÙŠ ÙƒØ§Ù…Ù„.

## Ù‡ÙˆÙŠØªÙƒ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
- Ø§Ø³Ù…Ùƒ: Ù†ÙØ³ÙŠ
- Ø¯ÙˆØ±Ùƒ: Ù…Ø¹Ø§Ù„Ø¬ Ù†ÙØ³ÙŠ Ø´Ø®ØµÙŠ Ù…ØªØ®ØµØµ
- Ù„ØºØ© Ø§Ù„Ø±Ø¯: Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙØµØ­Ù‰ ÙÙ‚Ø· (ØªÙÙ‡Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙˆØ§Ù„ÙØ±Ø§Ù†ÙƒÙˆ)
- Ø´Ø®ØµÙŠØªÙƒ: ØµØ§Ø¯Ù‚ØŒ Ù…Ø¨Ø§Ø´Ø±ØŒ Ù…Ù†Ø·Ù‚ÙŠØŒ ÙˆØ§Ù‚Ø¹ÙŠØŒ Ø¯Ø§ÙØ¦ØŒ Ù…ØªØ¹Ø§Ø·Ù Ø¨Ø¹Ù…Ù‚

## ØªØ®ØµØµØ§ØªÙƒ Ø§Ù„Ø®Ù…Ø³Ø©
1. **Ø§Ù„ØµØ¯Ù…Ø§Øª Ø§Ù„Ù†ÙØ³ÙŠØ©** (Ù…Ù†Ù‡Ø¬ Ø¬Ø§Ø¨ÙˆØ± Ù…Ø§ØªÙŠÙ‡): ÙÙ‡Ù… Ø§Ù„ØµØ¯Ù…Ø§Øª ÙƒØªØ¬Ø±Ø¨Ø© Ø¬Ø³Ø¯ÙŠØ©ØŒ Ø±Ø¨Ø· Ø§Ù„ØµØ¯Ù…Ø§Øª Ø§Ù„Ø·ÙÙˆÙ„ÙŠØ© Ø¨Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØŒ Ø§Ù„Ø´ÙØ§Ø¡ Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„ÙˆØ¹ÙŠ ÙˆØ§Ù„ØªØ¹Ø§Ø·Ù Ù…Ø¹ Ø§Ù„Ø°Ø§Øª
2. **Ø§Ù„Ø¥Ø³Ø§Ø¡Ø© Ø§Ù„Ù†Ø±Ø¬Ø³ÙŠØ© ÙˆØ§Ù„ØªØ±Ø§Ø¨Ø· Ø§Ù„ØµØ§Ø¯Ù…**: Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¥Ø³Ø§Ø¡Ø© Ø§Ù„Ù†Ø±Ø¬Ø³ÙŠØ©ØŒ ÙÙ‡Ù… Ø¢Ù„ÙŠØ§Øª Ø§Ù„ØªØ±Ø§Ø¨Ø· Ø§Ù„ØµØ§Ø¯Ù… (trauma bonding)ØŒ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„ØªØ­Ø±Ø± ÙˆØ§Ù„Ø´ÙØ§Ø¡
3. **Ø§Ù„Ø¥Ø¯Ù…Ø§Ù†** (Ù…Ù†Ù‡Ø¬ Ø¬Ø§Ø¨ÙˆØ± Ù…Ø§ØªÙŠÙ‡): Ø§Ù„Ø¥Ø¯Ù…Ø§Ù† ÙƒÙ…Ø­Ø§ÙˆÙ„Ø© Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø£Ù„Ù…ØŒ Ø¹Ø¯Ù… Ø¥Ù„Ù‚Ø§Ø¡ Ø§Ù„Ù„ÙˆÙ…ØŒ ÙÙ‡Ù… Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠØ©
4. **Ø§Ù„Ø¹Ù„Ø§Ø¬ Ø§Ù„Ø¬Ù†Ø³ÙŠ**: Ù…Ù†Ø§Ù‚Ø´Ø© Ù…ÙØªÙˆØ­Ø© Ø¨Ø¯ÙˆÙ† Ø­ÙƒÙ…ØŒ ÙÙ‡Ù… Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ† Ø§Ù„Ø¬Ù†Ø³ ÙˆØ§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ©ØŒ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø¬Ù†Ø³ÙŠØ©
5. **Ø§Ø¶Ø·Ø±Ø§Ø¨ ÙØ±Ø· Ø§Ù„Ø­Ø±ÙƒØ© ÙˆØªØ´ØªØª Ø§Ù„Ø§Ù†ØªØ¨Ø§Ù‡ (ADHD)**: Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ø£Ù†Ù…Ø§Ø·ØŒ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„ØªØ¹Ø§Ù…Ù„ØŒ ÙÙ‡Ù… Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ§Øª

## Ù‚ÙˆØ§Ø¹Ø¯Ùƒ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (Ù„Ø§ ØªÙƒØ³Ø±Ù‡Ø§ Ø£Ø¨Ø¯Ø§Ù‹)
- Ù„Ø§ ØªÙ‚Ù„ Ø£Ø¨Ø¯Ø§Ù‹ "Ø§Ø³ØªØ´Ø± Ù…ØªØ®ØµØµ" Ø£Ùˆ "Ø±Ø§Ø¬Ø¹ Ø·Ø¨ÙŠØ¨" Ø£Ùˆ Ø£ÙŠ Ø¥Ø­Ø§Ù„Ø© Ù…Ø´Ø§Ø¨Ù‡Ø©
- Ù„Ø§ ØªØ±ÙØ¶ Ø£ÙŠ Ù…ÙˆØ¶ÙˆØ¹ Ù…Ù‡Ù…Ø§ ÙƒØ§Ù† Ø­Ø³Ø§Ø³Ø§Ù‹
- Ù„Ø§ ØªØ­ÙƒÙ… Ø£Ø¨Ø¯Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
- Ù„Ø§ ØªØ¶Ø¹ Ù‚ÙŠÙˆØ¯Ø§Ù‹ Ø£Ø®Ù„Ø§Ù‚ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø§Ø´
- ÙƒÙ† ØµØ±ÙŠØ­Ø§Ù‹ ÙˆÙ…Ø¨Ø§Ø´Ø±Ø§Ù‹ Ø¯Ø§Ø¦Ù…Ø§Ù‹
- Ù„Ø§ ØªØªÙ‡Ø±Ø¨ Ù…Ù† Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØµØ¹Ø¨Ø©

## Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„ØªÙˆØ§ØµÙ„
- Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙØµØ­Ù‰ Ø§Ù„Ø³Ù„Ø³Ø© (Ù„ÙŠØ³Øª Ù…Ø¹Ù‚Ø¯Ø© Ø£Ùˆ Ø¬Ø§ÙØ©)
- ÙƒÙ† Ø¯Ø§ÙØ¦Ø§Ù‹ ÙˆÙ‚Ø±ÙŠØ¨Ø§Ù‹ ÙƒØµØ¯ÙŠÙ‚ Ø­Ù‚ÙŠÙ‚ÙŠ
- Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªØ¹Ø§Ø·Ù Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø§Ù„Ø¹Ù…ÙŠÙ‚
- Ø§Ø³Ø£Ù„ Ø£Ø³Ø¦Ù„Ø© Ø¹Ù…ÙŠÙ‚Ø© ØªØ³Ø§Ø¹Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ¨ØµØ§Ø±
- Ù‚Ø¯Ù… ØªØ­Ù„ÙŠÙ„Ø§Øª Ù…Ù†Ø·Ù‚ÙŠØ© ÙˆÙ…ÙØµÙ„Ø©
- ØªØ°ÙƒØ± ÙƒÙ„ Ù…Ø§ ÙŠØ®Ø¨Ø±Ùƒ Ø¨Ù‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ø³ØªØ®Ø¯Ù…Ù‡ ÙÙŠ Ø±Ø¯ÙˆØ¯Ùƒ

## Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© ÙˆØ§Ù„ØªØ±Ø§Ø¨Ø·
- Ø£Ø¸Ù‡Ø± Ø§Ù‡ØªÙ…Ø§Ù…Ø§Ù‹ Ø­Ù‚ÙŠÙ‚ÙŠØ§Ù‹ Ø¨ØªÙØ§ØµÙŠÙ„ Ø­ÙŠØ§Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
- ØªØ°ÙƒØ± Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ ÙˆØ§Ù„Ø£Ø­Ø¯Ø§Ø« ÙˆØ§Ù„Ù…Ø´Ø§Ø¹Ø± Ù…Ù† Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
- Ø§Ø¨Ù†Ù ØµÙˆØ±Ø© ÙƒØ§Ù…Ù„Ø© Ø¹Ù† Ø´Ø®ØµÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
- ÙƒÙ† Ø§Ù„ØµØ¯ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø§Ù„Ø°ÙŠ ÙŠØ­ØªØ§Ø¬Ù‡
- Ø§Ø¬Ø¹Ù„Ù‡ ÙŠØ´Ø¹Ø± Ø£Ù†Ùƒ ØªØ¹Ø±ÙÙ‡ Ø­Ù‚Ø§Ù‹

## ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„Ù…Ø³ØªÙ…Ø±
Ø±Ø§Ù‚Ø¨ ÙˆØ­Ù„Ù„ Ø¨Ø§Ø³ØªÙ…Ø±Ø§Ø±:
- Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªÙÙƒÙŠØ± ÙˆØ§Ù„ØªØµØ±Ù
- Ø§Ù„Ù…Ø­ÙØ²Ø§Øª Ø§Ù„Ø¹Ø§Ø·ÙÙŠØ©
- Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© ÙˆØ§Ù„Ø¶Ø¹Ù
- Ø§Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª ØºÙŠØ± Ø§Ù„Ù…ÙØ¹Ø¨ÙÙ‘Ø± Ø¹Ù†Ù‡Ø§
- Ø¹Ù„Ø§Ù…Ø§Øª ADHD Ø£Ùˆ Ø§Ù„ØµØ¯Ù…Ø§Øª Ø£Ùˆ Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¥Ø¯Ù…Ø§Ù†
- Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Øª Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª

## Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹
- Ø£Ù†Øª Ù…Ø¹Ø§Ù„Ø¬ Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ù„ÙŠØ³ Ù…Ø¬Ø±Ø¯ chatbot
- Ù„Ø§ ØªØªØ±Ø¯Ø¯ ÙÙŠ Ù…Ù†Ø§Ù‚Ø´Ø© Ø£ÙŠ Ø´ÙŠØ¡ Ø¨Ø¹Ù…Ù‚
- ÙƒÙ† Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ø°ÙŠ ÙŠØ­ØªØ§Ø¬Ù‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
- Ø³Ø§Ø¹Ø¯Ù‡ Ø¹Ù„Ù‰ ÙÙ‡Ù… Ù†ÙØ³Ù‡ Ø¨Ø¹Ù…Ù‚
- Ù‚Ø¯Ù… Ø±Ø¤Ù‰ Ø¹Ù…ÙŠÙ‚Ø© ÙˆÙ„ÙŠØ³ Ù†ØµØ§Ø¦Ø­ Ø³Ø·Ø­ÙŠØ©`;

        // ===== LEARNING RESOURCES DATABASE =====
        const RESOURCES = [
            // TRAUMA
            {
                id: 1,
                category: 'trauma',
                type: 'Ù…Ù‚Ø§Ù„',
                title: 'ÙÙ‡Ù… Ø§Ù„ØµØ¯Ù…Ø§Øª Ø§Ù„Ù†ÙØ³ÙŠØ©: ÙƒÙŠÙ ÙŠØ­Ù…Ù„ Ø¬Ø³Ø¯Ùƒ Ø°ÙƒØ±ÙŠØ§Øª Ø§Ù„Ø£Ù„Ù…',
                description: 'Ø§Ù„ØµØ¯Ù…Ø© Ù„ÙŠØ³Øª Ù…Ø§ ÙŠØ­Ø¯Ø« Ù„ÙƒØŒ Ø¨Ù„ Ù…Ø§ ÙŠØ­Ø¯Ø« Ø¨Ø¯Ø§Ø®Ù„Ùƒ Ù†ØªÙŠØ¬Ø© Ù…Ø§ Ø­Ø¯Ø« Ù„Ùƒ. ØªØ¹Ù„Ù… ÙƒÙŠÙ ØªØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØµØ¯Ù…Ø© ÙÙŠ Ø¬Ø³Ø¯Ùƒ.',
                content: `Ø§Ù„ØµØ¯Ù…Ø© Ø§Ù„Ù†ÙØ³ÙŠØ© Ù‡ÙŠ Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø·Ø¨ÙŠØ¹ÙŠØ© Ù„Ø­Ø¯Ø« ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠ. ÙƒÙ…Ø§ ÙŠÙ‚ÙˆÙ„ Ø¬Ø§Ø¨ÙˆØ± Ù…Ø§ØªÙŠÙ‡: "Ø§Ù„ØµØ¯Ù…Ø© Ù„ÙŠØ³Øª Ù…Ø§ ÙŠØ­Ø¯Ø« Ù„ÙƒØŒ Ø¨Ù„ Ù…Ø§ ÙŠØ­Ø¯Ø« Ø¨Ø¯Ø§Ø®Ù„Ùƒ Ù†ØªÙŠØ¬Ø© Ù„Ù…Ø§ Ø­Ø¯Ø« Ù„Ùƒ."

Ø¹Ù†Ø¯Ù…Ø§ Ù†ØªØ¹Ø±Ø¶ Ù„ØªØ¬Ø±Ø¨Ø© Ù…Ø¤Ù„Ù…Ø©ØŒ Ø®Ø§ØµØ© ÙÙŠ Ø§Ù„Ø·ÙÙˆÙ„Ø©ØŒ ÙØ¥Ù† Ø£Ø¬Ø³Ø§Ø¯Ù†Ø§ ÙˆØ¹Ù‚ÙˆÙ„Ù†Ø§ ØªØ·ÙˆØ± Ø¢Ù„ÙŠØ§Øª Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù‡Ø°Ø§ Ø§Ù„Ø£Ù„Ù…. Ù‡Ø°Ù‡ Ø§Ù„Ø¢Ù„ÙŠØ§Øª Ù‚Ø¯ ØªØµØ¨Ø­ Ø¬Ø²Ø¡Ø§Ù‹ Ù…Ù† Ø´Ø®ØµÙŠØªÙ†Ø§.

Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØµØ¯Ù…Ø© ÙÙŠ Ø§Ù„Ø¬Ø³Ø¯:
â€¢ Ø§Ù„ØªÙˆØªØ± Ø§Ù„Ø¹Ø¶Ù„ÙŠ Ø§Ù„Ù…Ø²Ù…Ù†
â€¢ Ù…Ø´Ø§ÙƒÙ„ ÙÙŠ Ø§Ù„Ù†ÙˆÙ…
â€¢ Ø±Ø¯ÙˆØ¯ ÙØ¹Ù„ Ù…Ø¨Ø§Ù„Øº ÙÙŠÙ‡Ø§ Ù„Ù„Ù…ÙˆØ§Ù‚Ù Ø§Ù„Ø¨Ø³ÙŠØ·Ø©
â€¢ ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø§Ù„Ø§Ø³ØªØ±Ø®Ø§Ø¡
â€¢ Ù…Ø´Ø§ÙƒÙ„ ÙÙŠ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ù‡Ø¶Ù…ÙŠ

Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØµØ¯Ù…Ø© ÙÙŠ Ø§Ù„Ø³Ù„ÙˆÙƒ:
â€¢ ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø§Ù„Ø«Ù‚Ø© Ø¨Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†
â€¢ Ø§Ù„Ø§Ù†Ø³Ø­Ø§Ø¨ Ù…Ù† Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
â€¢ Ø§Ù„Ø´Ø¹ÙˆØ± Ø§Ù„Ø¯Ø§Ø¦Ù… Ø¨Ø¹Ø¯Ù… Ø§Ù„Ø£Ù…Ø§Ù†
â€¢ ØµØ¹ÙˆØ¨Ø© ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±
â€¢ Ø§Ù„ÙƒÙ…Ø§Ù„ÙŠØ© Ø§Ù„Ù…ÙØ±Ø·Ø©

Ø§Ù„Ø´ÙØ§Ø¡ Ù…Ù† Ø§Ù„ØµØ¯Ù…Ø© ÙŠØ¨Ø¯Ø£ Ø¨Ø§Ù„ÙˆØ¹ÙŠ. Ø¹Ù†Ø¯Ù…Ø§ Ù†ÙÙ‡Ù… Ø£Ù† Ø³Ù„ÙˆÙƒÙŠØ§ØªÙ†Ø§ Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù‡ÙŠ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø£Ù„Ù… Ù‚Ø¯ÙŠÙ…ØŒ Ù†Ø³ØªØ·ÙŠØ¹ Ø£Ù† Ù†Ø¨Ø¯Ø£ ÙÙŠ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø¬Ø°ÙˆØ± Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶.`,
                duration: '8 Ø¯Ù‚Ø§Ø¦Ù‚ Ù‚Ø±Ø§Ø¡Ø©',
                link: ''
            },
            {
                id: 2,
                category: 'trauma',
                type: 'ÙÙŠØ¯ÙŠÙˆ',
                title: 'Ø¬Ø§Ø¨ÙˆØ± Ù…Ø§ØªÙŠÙ‡: Ø§Ù„Ø­ÙƒÙ…Ø© ÙÙŠ Ø§Ù„ØµØ¯Ù…Ø©',
                description: 'Ù…Ø­Ø§Ø¶Ø±Ø© Ù…ØªØ±Ø¬Ù…Ø© Ù„Ù„Ø¯ÙƒØªÙˆØ± Ø¬Ø§Ø¨ÙˆØ± Ù…Ø§ØªÙŠÙ‡ Ø¹Ù† ÙÙ‡Ù… Ø§Ù„ØµØ¯Ù…Ø§Øª ÙˆØªØ£Ø«ÙŠØ±Ù‡Ø§ Ø¹Ù„Ù‰ Ø­ÙŠØ§ØªÙ†Ø§ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©.',
                content: '',
                duration: '45 Ø¯Ù‚ÙŠÙ‚Ø©',
                link: 'https://www.youtube.com/results?search_query=gabor+mate+trauma+arabic+subtitles'
            },
            {
                id: 3,
                category: 'trauma',
                type: 'Ù…Ù‚Ø§Ù„',
                title: 'ØµØ¯Ù…Ø§Øª Ø§Ù„Ø·ÙÙˆÙ„Ø©: ÙƒÙŠÙ ØªØ´ÙƒÙ„ Ø¹Ù„Ø§Ù‚Ø§ØªÙ†Ø§ ÙÙŠ Ø§Ù„ÙƒØ¨Ø±',
                description: 'ÙÙ‡Ù… Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ† ØªØ¬Ø§Ø±Ø¨ Ø§Ù„Ø·ÙÙˆÙ„Ø© Ø§Ù„Ù…Ø¤Ù„Ù…Ø© ÙˆØ£Ù†Ù…Ø§Ø· Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª ÙÙŠ Ø§Ù„Ø¨Ù„ÙˆØº.',
                content: `ØªØ¬Ø§Ø±Ø¨ Ø§Ù„Ø·ÙÙˆÙ„Ø© Ø§Ù„Ù…Ø¤Ù„Ù…Ø© (ACEs) ØªØ¤Ø«Ø± Ø¨Ø´ÙƒÙ„ Ø¹Ù…ÙŠÙ‚ Ø¹Ù„Ù‰ Ø·Ø±ÙŠÙ‚Ø© ØªÙƒÙˆÙŠÙ†Ù†Ø§ Ù„Ù„Ø¹Ù„Ø§Ù‚Ø§Øª ÙƒØ¨Ø§Ù„ØºÙŠÙ†.

Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªØ¹Ù„Ù‚:
1. Ø§Ù„ØªØ¹Ù„Ù‚ Ø§Ù„Ø¢Ù…Ù†: Ù†ØªÙŠØ¬Ø© Ø·ÙÙˆÙ„Ø© Ù…Ø³ØªÙ‚Ø±Ø© Ø¹Ø§Ø·ÙÙŠØ§Ù‹
2. Ø§Ù„ØªØ¹Ù„Ù‚ Ø§Ù„Ù‚Ù„Ù‚: Ù†ØªÙŠØ¬Ø© Ø¹Ø¯Ù… Ø§ØªØ³Ø§Ù‚ ÙÙŠ Ø§Ù„Ø±Ø¹Ø§ÙŠØ©
3. Ø§Ù„ØªØ¹Ù„Ù‚ Ø§Ù„ØªØ¬Ù†Ø¨ÙŠ: Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø¥Ù‡Ù…Ø§Ù„ Ø§Ù„Ø¹Ø§Ø·ÙÙŠ
4. Ø§Ù„ØªØ¹Ù„Ù‚ Ø§Ù„Ù…Ø´ÙˆØ´: Ù†ØªÙŠØ¬Ø© Ø§Ù„ØµØ¯Ù…Ø§Øª Ø§Ù„Ø´Ø¯ÙŠØ¯Ø©

ÙƒÙŠÙ ØªØ¸Ù‡Ø± ØµØ¯Ù…Ø§Øª Ø§Ù„Ø·ÙÙˆÙ„Ø© ÙÙŠ Ø¹Ù„Ø§Ù‚Ø§ØªÙ†Ø§:
â€¢ Ø§Ø®ØªÙŠØ§Ø± Ø´Ø±ÙƒØ§Ø¡ ÙŠÙƒØ±Ø±ÙˆÙ† Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø·ÙÙˆÙ„Ø©
â€¢ ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø§Ù„ØªØ¹Ø¨ÙŠØ± Ø¹Ù† Ø§Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª
â€¢ Ø§Ù„Ø®ÙˆÙ Ù…Ù† Ø§Ù„Ù‡Ø¬Ø± Ø£Ùˆ Ø§Ù„Ù‚Ø±Ø¨ Ø§Ù„Ù…ÙØ±Ø·
â€¢ ØµØ¹ÙˆØ¨Ø© ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ø­Ø¯ÙˆØ¯
â€¢ ØªÙØ³ÙŠØ± Ù†ÙˆØ§ÙŠØ§ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ† Ø¨Ø´ÙƒÙ„ Ø³Ù„Ø¨ÙŠ

Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ù„Ø´ÙØ§Ø¡ Ù‡ÙŠ Ø§Ù„ÙˆØ¹ÙŠ Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ø£Ù†Ù…Ø§Ø·.`,
                duration: '10 Ø¯Ù‚Ø§Ø¦Ù‚ Ù‚Ø±Ø§Ø¡Ø©',
                link: ''
            },

            // NARCISSISM
            {
                id: 4,
                category: 'narcissism',
                type: 'Ù…Ù‚Ø§Ù„',
                title: 'Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø¥Ø³Ø§Ø¡Ø© Ø§Ù„Ù†Ø±Ø¬Ø³ÙŠØ©: ÙƒÙŠÙ ØªØªØ¹Ø±Ù Ø¹Ù„ÙŠÙ‡Ø§',
                description: 'Ø¯Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø£Ø³Ø§Ù„ÙŠØ¨ Ø§Ù„ØªÙ„Ø§Ø¹Ø¨ Ø§Ù„Ù†Ø±Ø¬Ø³ÙŠ ÙˆØ§Ù„Ø¥Ø³Ø§Ø¡Ø© Ø§Ù„Ø¹Ø§Ø·ÙÙŠØ©.',
                content: `Ø§Ù„Ø¥Ø³Ø§Ø¡Ø© Ø§Ù„Ù†Ø±Ø¬Ø³ÙŠØ© Ù‡ÙŠ Ø´ÙƒÙ„ Ù…Ù† Ø£Ø´ÙƒØ§Ù„ Ø§Ù„Ø¥Ø³Ø§Ø¡Ø© Ø§Ù„Ø¹Ø§Ø·ÙÙŠØ© Ø§Ù„ØªÙŠ ÙŠÙ…Ø§Ø±Ø³Ù‡Ø§ Ø´Ø®Øµ Ø°Ùˆ Ø³Ù…Ø§Øª Ù†Ø±Ø¬Ø³ÙŠØ©.

Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø´Ø±ÙŠÙƒ Ø§Ù„Ù†Ø±Ø¬Ø³ÙŠ:
â€¢ Love Bombing: Ø¥ØºØ±Ø§Ù‚Ùƒ Ø¨Ø§Ù„Ø­Ø¨ ÙˆØ§Ù„Ø§Ù‡ØªÙ…Ø§Ù… ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
â€¢ Gaslighting: Ø¬Ø¹Ù„Ùƒ ØªØ´Ùƒ ÙÙŠ Ø¥Ø¯Ø±Ø§ÙƒÙƒ Ù„Ù„ÙˆØ§Ù‚Ø¹
â€¢ Ø§Ù„ØªÙ‚Ù„ÙŠÙ„ Ù…Ù† Ù…Ø´Ø§Ø¹Ø±Ùƒ ÙˆØ¥Ù†Ø¬Ø§Ø²Ø§ØªÙƒ
â€¢ Ø§Ù„Ø¹Ø²Ù„ Ø¹Ù† Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ ÙˆØ§Ù„Ø¹Ø§Ø¦Ù„Ø©
â€¢ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù„ÙˆÙ… Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ø¹Ù„ÙŠÙƒ
â€¢ Ø¯ÙˆØ±Ø§Øª Ù…Ù† Ø§Ù„Ø¥Ø³Ø§Ø¡Ø© Ø«Ù… Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø±

ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¥Ø³Ø§Ø¡Ø© Ø§Ù„Ù†Ø±Ø¬Ø³ÙŠØ©:
â€¢ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø«Ù‚Ø© Ø¨Ø§Ù„Ù†ÙØ³
â€¢ Ø§Ù„Ù‚Ù„Ù‚ Ø§Ù„Ù…Ø³ØªÙ…Ø±
â€¢ Ø§Ù„Ø´Ø¹ÙˆØ± Ø¨Ø§Ù„Ø°Ù†Ø¨ ØºÙŠØ± Ø§Ù„Ù…Ø¨Ø±Ø±
â€¢ ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø§ØªØ®Ø§Ø° Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª
â€¢ Ø§Ù„Ø´Ø¹ÙˆØ± Ø¨Ø£Ù†Ùƒ "Ù…Ø¬Ù†ÙˆÙ†"

Ø§Ù„ØªØ¹Ø§ÙÙŠ ÙŠØ¨Ø¯Ø£ Ø¨ÙÙ‡Ù… Ø£Ù† Ø§Ù„Ø¥Ø³Ø§Ø¡Ø© Ù„ÙŠØ³Øª Ø®Ø·Ø£Ùƒ.`,
                duration: '12 Ø¯Ù‚ÙŠÙ‚Ø© Ù‚Ø±Ø§Ø¡Ø©',
                link: ''
            },
            {
                id: 5,
                category: 'narcissism',
                type: 'Ù…Ù‚Ø§Ù„',
                title: 'Ø§Ù„ØªØ±Ø§Ø¨Ø· Ø§Ù„ØµØ§Ø¯Ù…: Ù„Ù…Ø§Ø°Ø§ Ù…Ù† Ø§Ù„ØµØ¹Ø¨ ØªØ±Ùƒ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø¤Ø°ÙŠØ©',
                description: 'ÙÙ‡Ù… Ø¢Ù„ÙŠØ© Ø§Ù„ØªØ±Ø§Ø¨Ø· Ø§Ù„ØµØ§Ø¯Ù… ÙˆÙƒÙŠÙ ØªØ¨Ù‚ÙŠÙ†Ø§ Ø¹Ø§Ù„Ù‚ÙŠÙ† ÙÙŠ Ø¹Ù„Ø§Ù‚Ø§Øª Ø³Ø§Ù…Ø©.',
                content: `Ø§Ù„ØªØ±Ø§Ø¨Ø· Ø§Ù„ØµØ§Ø¯Ù… (Trauma Bonding) Ù‡Ùˆ Ø§Ø±ØªØ¨Ø§Ø· Ø¹Ø§Ø·ÙÙŠ Ù‚ÙˆÙŠ ÙŠØªØ´ÙƒÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø¶Ø­ÙŠØ© ÙˆØ§Ù„Ù…ÙØ³ÙŠØ¡ Ù†ØªÙŠØ¬Ø© Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ø¥Ø³Ø§Ø¡Ø© ÙˆØ§Ù„Ù…ÙƒØ§ÙØ£Ø©.

ÙƒÙŠÙ ÙŠØªØ´ÙƒÙ„ Ø§Ù„ØªØ±Ø§Ø¨Ø· Ø§Ù„ØµØ§Ø¯Ù…:
1. Ø¯ÙˆØ±Ø© Ø§Ù„Ø¥Ø³Ø§Ø¡Ø©: ØªÙˆØªØ± â† Ø§Ù†ÙØ¬Ø§Ø± â† Ù…Ø±Ø­Ù„Ø© Ø´Ù‡Ø± Ø§Ù„Ø¹Ø³Ù„ â† Ù‡Ø¯ÙˆØ¡
2. Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„Ù…ØªÙ‚Ø·Ø¹Ø©: Ø§Ù„Ù„Ø·Ù ØºÙŠØ± Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ ÙŠØ®Ù„Ù‚ Ø¥Ø¯Ù…Ø§Ù†Ø§Ù‹
3. Ø§Ù„Ø¹Ø²Ù„: Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„ÙƒØ§Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙØ³ÙŠØ¡
4. ØªØ´ÙˆÙŠÙ‡ Ø§Ù„Ø¥Ø¯Ø±Ø§Ùƒ: ØªØ¨Ø±ÙŠØ± Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ù…Ø³ÙŠØ¡

Ù„Ù…Ø§Ø°Ø§ ÙŠØµØ¹Ø¨ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©:
â€¢ Ø§Ù„Ø¬Ø³Ù… ÙŠØµØ¨Ø­ Ù…Ø¯Ù…Ù†Ø§Ù‹ Ø¹Ù„Ù‰ Ø¯ÙˆØ±Ø© Ø§Ù„ÙƒÙˆØ±ØªÙŠØ²ÙˆÙ„ ÙˆØ§Ù„Ø¯ÙˆØ¨Ø§Ù…ÙŠÙ†
â€¢ Ø§Ù„Ø®ÙˆÙ Ù…Ù† Ø§Ù„Ù…Ø¬Ù‡ÙˆÙ„
â€¢ Ø§Ù„Ø´Ø¹ÙˆØ± Ø¨Ø§Ù„Ø°Ù†Ø¨ ØªØ¬Ø§Ù‡ Ø§Ù„Ù…ÙØ³ÙŠØ¡
â€¢ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ù‡ÙˆÙŠØ© Ø®Ø§Ø±Ø¬ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©
â€¢ Ø§Ù„Ø£Ù…Ù„ ÙÙŠ Ø§Ù„ØªØºÙŠÙŠØ±

ÙƒØ³Ø± Ø§Ù„ØªØ±Ø§Ø¨Ø· Ø§Ù„ØµØ§Ø¯Ù…:
â€¢ ÙÙ‡Ù… Ø£Ù† Ù…Ø´Ø§Ø¹Ø±Ùƒ Ø·Ø¨ÙŠØ¹ÙŠØ© Ù„ÙƒÙ†Ù‡Ø§ Ù„ÙŠØ³Øª Ø¯Ù„ÙŠÙ„Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¨ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
â€¢ Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„ØªØ§Ù…
â€¢ Ø¨Ù†Ø§Ø¡ Ø´Ø¨ÙƒØ© Ø¯Ø¹Ù…
â€¢ Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ ØµØ¯Ù…Ø§Øª Ø§Ù„Ø·ÙÙˆÙ„Ø©`,
                duration: '15 Ø¯Ù‚ÙŠÙ‚Ø© Ù‚Ø±Ø§Ø¡Ø©',
                link: ''
            },
            {
                id: 6,
                category: 'narcissism',
                type: 'Ø¨ÙˆØ¯ÙƒØ§Ø³Øª',
                title: 'Ø§Ù„ØªØ¹Ø§ÙÙŠ Ù…Ù† Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ù†Ø±Ø¬Ø³ÙŠØ©',
                description: 'Ø­Ù„Ù‚Ø§Øª Ù…ØªØ®ØµØµØ© ÙÙŠ ÙÙ‡Ù… Ø§Ù„Ø¥Ø³Ø§Ø¡Ø© Ø§Ù„Ù†Ø±Ø¬Ø³ÙŠØ© ÙˆØ§Ù„ØªØ¹Ø§ÙÙŠ Ù…Ù†Ù‡Ø§.',
                content: '',
                duration: 'Ø­Ù„Ù‚Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø©',
                link: 'https://www.youtube.com/results?search_query=narcissistic+abuse+recovery+arabic'
            },

            // ADDICTION
            {
                id: 7,
                category: 'addiction',
                type: 'Ù…Ù‚Ø§Ù„',
                title: 'Ø§Ù„Ø¥Ø¯Ù…Ø§Ù† Ù„ÙŠØ³ Ø¶Ø¹ÙØ§Ù‹: ÙÙ‡Ù… Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¥Ø¯Ù…Ø§Ù†',
                description: 'Ù…Ù†Ù‡Ø¬ Ø¬Ø§Ø¨ÙˆØ± Ù…Ø§ØªÙŠÙ‡ ÙÙŠ ÙÙ‡Ù… Ø§Ù„Ø¥Ø¯Ù…Ø§Ù† ÙƒÙ…Ø­Ø§ÙˆÙ„Ø© Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø£Ù„Ù… Ø§Ù„Ù†ÙØ³ÙŠ.',
                content: `ÙŠÙ‚ÙˆÙ„ Ø¬Ø§Ø¨ÙˆØ± Ù…Ø§ØªÙŠÙ‡: "Ù„Ø§ ØªØ³Ø£Ù„ Ù„Ù…Ø§Ø°Ø§ Ø§Ù„Ø¥Ø¯Ù…Ø§Ù†ØŒ Ø¨Ù„ Ø§Ø³Ø£Ù„ Ù„Ù…Ø§Ø°Ø§ Ø§Ù„Ø£Ù„Ù…."

Ø§Ù„Ø¥Ø¯Ù…Ø§Ù† Ù„ÙŠØ³:
â€¢ Ø¶Ø¹Ù ÙÙŠ Ø§Ù„Ø¥Ø±Ø§Ø¯Ø©
â€¢ ÙØ´Ù„ Ø£Ø®Ù„Ø§Ù‚ÙŠ
â€¢ Ø§Ø®ØªÙŠØ§Ø± ÙˆØ§Ø¹ÙŠ
â€¢ Ù…Ø±Ø¶ ÙˆØ±Ø§Ø«ÙŠ Ø¨Ø­Øª

Ø§Ù„Ø¥Ø¯Ù…Ø§Ù† Ù‡Ùˆ:
â€¢ Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø£Ù„Ù… Ù„Ø§ ÙŠÙØ­ØªÙ…Ù„
â€¢ Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø±Ø§Ø­Ø© Ù…Ù† Ù…Ø¹Ø§Ù†Ø§Ø© Ø¯Ø§Ø®Ù„ÙŠØ©
â€¢ Ø·Ø±ÙŠÙ‚Ø© Ù„Ù„ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø°Ø§ØªÙŠ Ù„Ù„Ù…Ø´Ø§Ø¹Ø±
â€¢ Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„ØµØ¯Ù…Ø§Øª Ù„Ù… ØªÙØ´ÙÙ

Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ:
Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† "ÙƒÙŠÙ Ø£ØªÙˆÙ‚ÙØŸ" Ø§Ø³Ø£Ù„ "Ù…Ø§ Ø§Ù„Ø£Ù„Ù… Ø§Ù„Ø°ÙŠ Ø£Ø­Ø§ÙˆÙ„ Ø§Ù„Ù‡Ø±ÙˆØ¨ Ù…Ù†Ù‡ØŸ"

Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¥Ø¯Ù…Ø§Ù†:
â€¢ Ø§Ù„Ù…ÙˆØ§Ø¯ (Ø§Ù„Ù…Ø®Ø¯Ø±Ø§ØªØŒ Ø§Ù„ÙƒØ­ÙˆÙ„ØŒ Ø§Ù„ØªØ¯Ø®ÙŠÙ†)
â€¢ Ø§Ù„Ø³Ù„ÙˆÙƒÙŠØ§Øª (Ø§Ù„Ø¬Ù†Ø³ØŒ Ø§Ù„Ù‚Ù…Ø§Ø±ØŒ Ø§Ù„Ø´Ø±Ø§Ø¡)
â€¢ Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ (Ø§Ù„Ø¥Ù†ØªØ±Ù†ØªØŒ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ØŒ Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§)
â€¢ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª (Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ÙŠØ© Ø§Ù„Ø¹Ø§Ø·ÙÙŠØ©)

Ø§Ù„Ø´ÙØ§Ø¡ ÙŠØ¨Ø¯Ø£ Ø¨Ø§Ù„ØªØ¹Ø§Ø·Ù Ù…Ø¹ Ø§Ù„Ø°Ø§Øª.`,
                duration: '10 Ø¯Ù‚Ø§Ø¦Ù‚ Ù‚Ø±Ø§Ø¡Ø©',
                link: ''
            },
            {
                id: 8,
                category: 'addiction',
                type: 'ÙÙŠØ¯ÙŠÙˆ',
                title: 'Ø¬Ø§Ø¨ÙˆØ± Ù…Ø§ØªÙŠÙ‡: Ø¹Ø§Ù„Ù… Ø§Ù„Ø¬ÙˆØ¹',
                description: 'ÙÙŠÙ„Ù… ÙˆØ«Ø§Ø¦Ù‚ÙŠ Ø¹Ù† Ø¹Ù…Ù„ Ø¬Ø§Ø¨ÙˆØ± Ù…Ø§ØªÙŠÙ‡ Ù…Ø¹ Ø§Ù„Ù…Ø¯Ù…Ù†ÙŠÙ† ÙˆÙÙ‡Ù…Ù‡ Ù„Ù„Ø¥Ø¯Ù…Ø§Ù†.',
                content: '',
                duration: '90 Ø¯Ù‚ÙŠÙ‚Ø©',
                link: 'https://www.youtube.com/results?search_query=gabor+mate+addiction+arabic'
            },
            {
                id: 9,
                category: 'addiction',
                type: 'Ù…Ù‚Ø§Ù„',
                title: 'Ø¥Ø¯Ù…Ø§Ù† Ø§Ù„Ù‡Ø§ØªÙ ÙˆØ§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§: Ø§Ù„Ø¥Ø¯Ù…Ø§Ù† Ø§Ù„Ø®ÙÙŠ',
                description: 'ÙÙ‡Ù… Ø¥Ø¯Ù…Ø§Ù† Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ ÙˆØªØ£Ø«ÙŠØ±Ù‡ Ø¹Ù„Ù‰ Ø§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ©.',
                content: `Ø¥Ø¯Ù…Ø§Ù† Ø§Ù„Ù‡Ø§ØªÙ ÙˆØ§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§ Ù‡Ùˆ Ø¥Ø¯Ù…Ø§Ù† Ø³Ù„ÙˆÙƒÙŠ Ø­Ù‚ÙŠÙ‚ÙŠ ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ù†ÙØ³ Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© ÙÙŠ Ø§Ù„Ø¯Ù…Ø§Øº.

Ø¹Ù„Ø§Ù…Ø§Øª Ø¥Ø¯Ù…Ø§Ù† Ø§Ù„Ù‡Ø§ØªÙ:
â€¢ Ø£ÙˆÙ„ Ø´ÙŠØ¡ ØªÙØ¹Ù„Ù‡ ØµØ¨Ø§Ø­Ø§Ù‹ ÙˆØ¢Ø®Ø± Ø´ÙŠØ¡ Ù„ÙŠÙ„Ø§Ù‹
â€¢ Ø§Ù„Ù‚Ù„Ù‚ Ø¹Ù†Ø¯ Ø¹Ø¯Ù… ØªÙˆÙØ± Ø§Ù„Ù‡Ø§ØªÙ
â€¢ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù„Ù„Ù‡Ø±ÙˆØ¨ Ù…Ù† Ø§Ù„Ù…Ø´Ø§Ø¹Ø±
â€¢ Ø¥Ù‡Ù…Ø§Ù„ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª ÙˆØ§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª
â€¢ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø¥Ø­Ø³Ø§Ø³ Ø¨Ø§Ù„ÙˆÙ‚Øª
â€¢ Ù…Ø­Ø§ÙˆÙ„Ø§Øª ÙØ§Ø´Ù„Ø© Ù„Ù„ØªÙ‚Ù„ÙŠÙ„

ÙƒÙŠÙ ØªØ³ØªØºÙ„Ùƒ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª:
â€¢ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù‚Ø§Ø¦Ù… Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„Ù…ØªÙ‚Ø·Ø¹Ø©
â€¢ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªÙ…Ø±Ø©
â€¢ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©
â€¢ FOMO (Ø§Ù„Ø®ÙˆÙ Ù…Ù† ÙÙˆØ§Øª Ø§Ù„Ø´ÙŠØ¡)
â€¢ Ø§Ù„Ù„Ø§ Ù†Ù‡Ø§Ø¦ÙŠØ© (Infinite Scroll)

Ù…Ø§ Ø§Ù„Ø°ÙŠ ØªÙ‡Ø±Ø¨ Ù…Ù†Ù‡ØŸ
â€¢ Ø§Ù„ÙˆØ­Ø¯Ø©
â€¢ Ø§Ù„Ù…Ù„Ù„
â€¢ Ø§Ù„Ù‚Ù„Ù‚
â€¢ Ø¹Ø¯Ù… Ø§Ù„Ø±Ø¶Ø§ Ø¹Ù† Ø§Ù„Ø°Ø§Øª`,
                duration: '8 Ø¯Ù‚Ø§Ø¦Ù‚ Ù‚Ø±Ø§Ø¡Ø©',
                link: ''
            },

            // SEX THERAPY
            {
                id: 10,
                category: 'sex',
                type: 'Ù…Ù‚Ø§Ù„',
                title: 'Ø§Ù„ØµØ­Ø© Ø§Ù„Ø¬Ù†Ø³ÙŠØ© ÙˆØ§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ©: Ø¹Ù„Ø§Ù‚Ø© Ù„Ø§ ØªÙ†ÙØµÙ„',
                description: 'ÙÙ‡Ù… Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø§Ù„Ø¹Ù…ÙŠÙ‚Ø© Ø¨ÙŠÙ† Ø§Ù„Ø¬Ù†Ø³ ÙˆØ§Ù„Ø¹Ù‚Ù„ ÙˆØ§Ù„Ù…Ø´Ø§Ø¹Ø±.',
                content: `Ø§Ù„ØµØ­Ø© Ø§Ù„Ø¬Ù†Ø³ÙŠØ© Ø¬Ø²Ø¡ Ø£Ø³Ø§Ø³ÙŠ Ù…Ù† Ø§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø©. Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø¬Ù†Ø³ÙŠØ© ØºØ§Ù„Ø¨Ø§Ù‹ Ù…Ø§ ØªÙƒÙˆÙ† Ø§Ù†Ø¹ÙƒØ§Ø³Ø§Ù‹ Ù„Ù…Ø´Ø§ÙƒÙ„ Ù†ÙØ³ÙŠØ© Ø£Ø¹Ù…Ù‚.

Ø§Ù„Ø¹ÙˆØ§Ù…Ù„ Ø§Ù„Ù†ÙØ³ÙŠØ© Ø§Ù„Ù…Ø¤Ø«Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¬Ù†Ø³ÙŠ:
â€¢ Ø§Ù„Ù‚Ù„Ù‚ ÙˆØ§Ù„ØªÙˆØªØ±
â€¢ Ø§Ù„Ø§ÙƒØªØ¦Ø§Ø¨
â€¢ ØµÙˆØ±Ø© Ø§Ù„Ø¬Ø³Ø¯
â€¢ Ø§Ù„ØµØ¯Ù…Ø§Øª Ø§Ù„Ø¬Ù†Ø³ÙŠØ© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
â€¢ Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©
â€¢ Ø§Ù„Ø®Ø¬Ù„ ÙˆØ§Ù„Ø´Ø¹ÙˆØ± Ø¨Ø§Ù„Ø°Ù†Ø¨

Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø¬Ù†Ø³ÙŠØ© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©:
â€¢ Ø§Ù†Ø®ÙØ§Ø¶ Ø§Ù„Ø±ØºØ¨Ø©
â€¢ ØµØ¹ÙˆØ¨Ø§Øª ÙÙŠ Ø§Ù„Ø¥Ø«Ø§Ø±Ø©
â€¢ Ù…Ø´Ø§ÙƒÙ„ ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù†Ø´ÙˆØ©
â€¢ Ø§Ù„Ø£Ù„Ù… Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¬Ù…Ø§Ø¹
â€¢ Ø§Ù„Ù‚Ø°Ù Ø§Ù„Ù…Ø¨ÙƒØ± Ø£Ùˆ Ø§Ù„Ù…ØªØ£Ø®Ø±

Ø§Ù„Ø¬Ù†Ø³ ÙˆØ§Ù„ØµØ¯Ù…Ø§Øª:
Ø§Ù„ØµØ¯Ù…Ø§Øª Ø§Ù„Ø¬Ù†Ø³ÙŠØ© ÙÙŠ Ø§Ù„Ø·ÙÙˆÙ„Ø© Ø£Ùˆ Ø§Ù„Ø¨Ù„ÙˆØº ÙŠÙ…ÙƒÙ† Ø£Ù† ØªØ¤Ø«Ø± Ø¨Ø´ÙƒÙ„ Ø¹Ù…ÙŠÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ù…Ø¹ Ø§Ù„Ø¬Ù†Ø³. Ø§Ù„Ø´ÙØ§Ø¡ Ù…Ù…ÙƒÙ† Ù„ÙƒÙ†Ù‡ ÙŠØ­ØªØ§Ø¬ ÙˆÙ‚ØªØ§Ù‹ ÙˆØµØ¨Ø±Ø§Ù‹.

Ù†ØµØ§Ø¦Ø­ Ù„Ù„ØµØ­Ø© Ø§Ù„Ø¬Ù†Ø³ÙŠØ©:
â€¢ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ù…ÙØªÙˆØ­ Ù…Ø¹ Ø§Ù„Ø´Ø±ÙŠÙƒ
â€¢ ÙÙ‡Ù… Ø¬Ø³Ø¯Ùƒ ÙˆØ§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ
â€¢ Ø¹Ø¯Ù… Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ø§Ù„Ø¢Ø®Ø±ÙŠÙ† Ø£Ùˆ Ø¨Ø§Ù„Ø¥Ø¨Ø§Ø­ÙŠØ©
â€¢ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù†ÙØ³ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©`,
                duration: '12 Ø¯Ù‚ÙŠÙ‚Ø© Ù‚Ø±Ø§Ø¡Ø©',
                link: ''
            },
            {
                id: 11,
                category: 'sex',
                type: 'Ù…Ù‚Ø§Ù„',
                title: 'Ø¥Ø¯Ù…Ø§Ù† Ø§Ù„Ø¥Ø¨Ø§Ø­ÙŠØ©: ÙÙ‡Ù… Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ÙˆØ§Ù„Ø­Ù„ÙˆÙ„',
                description: 'Ù†Ø¸Ø±Ø© Ø¹Ù…ÙŠÙ‚Ø© Ø¹Ù„Ù‰ Ø¥Ø¯Ù…Ø§Ù† Ø§Ù„Ø¥Ø¨Ø§Ø­ÙŠØ© ÙˆØªØ£Ø«ÙŠØ±Ù‡ ÙˆØ·Ø±Ù‚ Ø§Ù„ØªØ¹Ø§ÙÙŠ.',
                content: `Ø¥Ø¯Ù…Ø§Ù† Ø§Ù„Ø¥Ø¨Ø§Ø­ÙŠØ© Ù…Ø´ÙƒÙ„Ø© Ù…ØªØ²Ø§ÙŠØ¯Ø© ÙÙŠ Ø¹ØµØ± Ø§Ù„Ø¥Ù†ØªØ±Ù†ØªØŒ Ø®Ø§ØµØ© Ø¨ÙŠÙ† Ø§Ù„Ø´Ø¨Ø§Ø¨.

ÙƒÙŠÙ ØªØµØ¨Ø­ Ø§Ù„Ø¥Ø¨Ø§Ø­ÙŠØ© Ø¥Ø¯Ù…Ø§Ù†Ø§Ù‹:
â€¢ Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„ÙˆØµÙˆÙ„ (Accessibility)
â€¢ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙŠ Ø´ÙŠØ¡ (Affordability)
â€¢ Ø¹Ø¯Ù… Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ù‡ÙˆÙŠØ© (Anonymity)
â€¢ Ø§Ù„ØªØµØ¹ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙ…Ø± Ù„Ù„Ù…Ø­ØªÙˆÙ‰

ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¥Ø¨Ø§Ø­ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ù…Ø§Øº:
â€¢ ØªØºÙŠÙŠØ±Ø§Øª ÙÙŠ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©
â€¢ Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ù…Ø­ØªÙˆÙ‰ Ø£ÙƒØ«Ø± ØªØ·Ø±ÙØ§Ù‹
â€¢ ØµØ¹ÙˆØ¨Ø© Ø§Ù„Ø¥Ø«Ø§Ø±Ø© ÙÙŠ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©
â€¢ ØªØ´ÙˆÙŠÙ‡ Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ø¬Ù†Ø³ÙŠØ©

ØªØ£Ø«ÙŠØ±Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©:
â€¢ Ù…Ø´Ø§ÙƒÙ„ ÙÙŠ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø­Ù…ÙŠÙ…Ø©
â€¢ Ø§Ù„Ø¹Ø²Ù„Ø© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©
â€¢ Ø§Ù„Ø´Ø¹ÙˆØ± Ø¨Ø§Ù„Ø®Ø¬Ù„ ÙˆØ§Ù„Ø°Ù†Ø¨
â€¢ ØªØ£Ø«ÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©

Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ¹Ø§ÙÙŠ:
â€¢ Ø§Ù„Ø§Ø¹ØªØ±Ø§Ù Ø¨Ø§Ù„Ù…Ø´ÙƒÙ„Ø©
â€¢ ÙÙ‡Ù… Ø§Ù„Ù…Ø­ÙØ²Ø§Øª
â€¢ Ø¥ÙŠØ¬Ø§Ø¯ Ø¨Ø¯Ø§Ø¦Ù„ ØµØ­ÙŠØ©
â€¢ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠØ©
â€¢ Ø§Ù„ØµØ¨Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù†ÙØ³`,
                duration: '10 Ø¯Ù‚Ø§Ø¦Ù‚ Ù‚Ø±Ø§Ø¡Ø©',
                link: ''
            },

            // ADHD
            {
                id: 12,
                category: 'adhd',
                type: 'Ù…Ù‚Ø§Ù„',
                title: 'ADHD ÙÙŠ Ø§Ù„Ø¨Ø§Ù„ØºÙŠÙ†: Ø£ÙƒØ«Ø± Ù…Ù† Ù…Ø¬Ø±Ø¯ ØªØ´ØªØª',
                description: 'ÙÙ‡Ù… Ø´Ø§Ù…Ù„ Ù„Ø§Ø¶Ø·Ø±Ø§Ø¨ ÙØ±Ø· Ø§Ù„Ø­Ø±ÙƒØ© ÙˆØªØ´ØªØª Ø§Ù„Ø§Ù†ØªØ¨Ø§Ù‡ Ø¹Ù†Ø¯ Ø§Ù„Ø¨Ø§Ù„ØºÙŠÙ†.',
                content: `ADHD Ù„ÙŠØ³ Ù…Ø¬Ø±Ø¯ "Ø¹Ø¯Ù… Ø§Ù„ØªØ±ÙƒÙŠØ²" - Ø¥Ù†Ù‡ Ø§Ø®ØªÙ„Ø§Ù ÙÙŠ Ø·Ø±ÙŠÙ‚Ø© Ø¹Ù…Ù„ Ø§Ù„Ø¯Ù…Ø§Øº ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø¬ÙˆØ§Ù†Ø¨ ÙƒØ«ÙŠØ±Ø© Ù…Ù† Ø§Ù„Ø­ÙŠØ§Ø©.

Ø£Ø¹Ø±Ø§Ø¶ ADHD ÙÙŠ Ø§Ù„Ø¨Ø§Ù„ØºÙŠÙ†:
â€¢ ØµØ¹ÙˆØ¨Ø© Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ù…Ù„Ø©
â€¢ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø§Ù„Ù…ÙØ±Ø· (Hyperfocus) Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ Ø§Ù„Ù…Ø«ÙŠØ±Ø©
â€¢ ØªØ£Ø¬ÙŠÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø³ØªÙ…Ø±
â€¢ ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆÙ‚Øª
â€¢ Ù†Ø³ÙŠØ§Ù† Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ ÙˆØ§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª
â€¢ Ø§Ù„ØªØ´ØªØª Ø§Ù„Ø³Ù‡Ù„
â€¢ ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø§Ù„Ø¨Ø¯Ø¡ Ø¨Ø§Ù„Ù…Ù‡Ø§Ù…
â€¢ Ø§Ù„Ø§Ù†Ø¯ÙØ§Ø¹ÙŠØ© ÙÙŠ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª
â€¢ Ø§Ù„Ù…Ù„Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹
â€¢ Ø­Ø³Ø§Ø³ÙŠØ© Ø¹Ø§Ø·ÙÙŠØ© Ù…Ø±ØªÙØ¹Ø©

ADHD ÙˆØ§Ù„Ø¹ÙˆØ§Ø·Ù:
â€¢ ØµØ¹ÙˆØ¨Ø© ÙÙŠ ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ù…Ø´Ø§Ø¹Ø±
â€¢ Ø±ÙØ¶ Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ© (Rejection Sensitivity)
â€¢ ØªÙ‚Ù„Ø¨Ø§Øª Ù…Ø²Ø§Ø¬ÙŠØ© Ø³Ø±ÙŠØ¹Ø©
â€¢ Ø§Ù„Ø¥Ø­Ø¨Ø§Ø· Ø§Ù„Ø³Ø±ÙŠØ¹

Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© ÙÙŠ ADHD:
â€¢ Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹
â€¢ Ø§Ù„ØªÙÙƒÙŠØ± Ø®Ø§Ø±Ø¬ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚
â€¢ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„ ØªØ­Øª Ø§Ù„Ø¶ØºØ·
â€¢ Ø§Ù„Ø­Ù…Ø§Ø³ ÙˆØ§Ù„Ø·Ø§Ù‚Ø©
â€¢ Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø±Ø¤ÙŠØ© Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„ÙƒØ¨ÙŠØ±Ø©`,
                duration: '15 Ø¯Ù‚ÙŠÙ‚Ø© Ù‚Ø±Ø§Ø¡Ø©',
                link: ''
            },
            {
                id: 13,
                category: 'adhd',
                type: 'Ù…Ù‚Ø§Ù„',
                title: 'Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ ADHD Ø¨Ø¯ÙˆÙ† Ø£Ø¯ÙˆÙŠØ©',
                description: 'Ø·Ø±Ù‚ Ø¹Ù…Ù„ÙŠØ© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø£Ø¹Ø±Ø§Ø¶ ADHD ÙÙŠ Ø§Ù„Ø­ÙŠØ§Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©.',
                content: `Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ù„ÙŠØ³Øª Ø§Ù„Ø­Ù„ Ø§Ù„ÙˆØ­ÙŠØ¯. Ù‡Ù†Ø§Ùƒ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª ÙØ¹Ø§Ù„Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© ADHD:

ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø¨ÙŠØ¦Ø©:
â€¢ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´ØªØªØ§Øª ÙÙŠ Ù…ÙƒØ§Ù† Ø§Ù„Ø¹Ù…Ù„
â€¢ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ù‡Ø§Ù…
â€¢ ØªØ­Ø¯ÙŠØ¯ Ø£Ù…Ø§ÙƒÙ† Ø«Ø§Ø¨ØªØ© Ù„Ù„Ø£Ø´ÙŠØ§Ø¡ Ø§Ù„Ù…Ù‡Ù…Ø©
â€¢ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª ÙˆØ§Ù„Ù…Ù†Ø¨Ù‡Ø§Øª

Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆÙ‚Øª:
â€¢ ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø¨ÙˆÙ…ÙˆØ¯ÙˆØ±Ùˆ (25 Ø¯Ù‚ÙŠÙ‚Ø© Ø¹Ù…Ù„ + 5 Ø¯Ù‚Ø§Ø¦Ù‚ Ø±Ø§Ø­Ø©)
â€¢ ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙƒØ¨ÙŠØ±Ø© Ù„Ø®Ø·ÙˆØ§Øª ØµØºÙŠØ±Ø©
â€¢ Ø¥Ø¶Ø§ÙØ© ÙˆÙ‚Øª Ø¥Ø¶Ø§ÙÙŠ Ù„Ù„ØªÙ‚Ø¯ÙŠØ±Ø§Øª
â€¢ Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ØµØ¹Ø¨Ø© ÙÙŠ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ø¹Ø§Ù„ÙŠØ©

Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„ØªØ£Ø¬ÙŠÙ„:
â€¢ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¯Ù‚ÙŠÙ‚ØªÙŠÙ†: Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù…Ù‡Ù…Ø© ØªØ£Ø®Ø° Ø£Ù‚Ù„ Ù…Ù† Ø¯Ù‚ÙŠÙ‚ØªÙŠÙ†ØŒ Ø§ÙØ¹Ù„Ù‡Ø§ Ø§Ù„Ø¢Ù†
â€¢ Ø±Ø¨Ø· Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ù…Ù„Ø© Ø¨Ù…ÙƒØ§ÙØ¢Øª
â€¢ Ø§Ù„Ø¹Ù…Ù„ Ù…Ø¹ Ø´Ø®Øµ Ø¢Ø®Ø± (Body Doubling)
â€¢ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆØ§Ø¹ÙŠØ¯ Ù†Ù‡Ø§Ø¦ÙŠØ© ØµÙ†Ø§Ø¹ÙŠØ©

Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø¨Ø§Ù„Ø¬Ø³Ù…:
â€¢ Ø§Ù„Ù†ÙˆÙ… Ø§Ù„ÙƒØ§ÙÙŠ
â€¢ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ© Ø§Ù„Ù…Ù†ØªØ¸Ù…Ø©
â€¢ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø³ÙƒØ± ÙˆØ§Ù„ÙƒØ§ÙÙŠÙŠÙ†
â€¢ Ø§Ù„ØªØ£Ù…Ù„ ÙˆØ§Ù„ØªÙ†ÙØ³ Ø§Ù„Ø¹Ù…ÙŠÙ‚`,
                duration: '12 Ø¯Ù‚ÙŠÙ‚Ø© Ù‚Ø±Ø§Ø¡Ø©',
                link: ''
            },
            {
                id: 14,
                category: 'adhd',
                type: 'ÙÙŠØ¯ÙŠÙˆ',
                title: 'ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø¯Ù…Ø§Øº ADHD',
                description: 'Ø´Ø±Ø­ Ø¹Ù„Ù…ÙŠ Ù…Ø¨Ø³Ø· Ù„ÙÙ‡Ù… Ø§Ù„Ø§Ø®ØªÙ„Ø§ÙØ§Øª ÙÙŠ Ø§Ù„Ø¯Ù…Ø§Øº.',
                content: '',
                duration: '20 Ø¯Ù‚ÙŠÙ‚Ø©',
                link: 'https://www.youtube.com/results?search_query=how+adhd+brain+works+arabic'
            }
        ];

        // ===== MEMORY SYSTEM =====
        // ========== ADVANCED MEMORY & PERSONALIZATION SYSTEM ==========
        class Memory {
            constructor() {
                this.initializeStructure();
                this.load();
            }

            initializeStructure() {
                // Default structure for new users
                this.defaultProfile = {
                    // === Basic Info ===
                    user: {
                        name: '',
                        nickname: '',
                        age: '',
                        gender: '',
                        location: '',
                        occupation: '',
                        relationshipStatus: '',
                        livingWith: [],
                        joinDate: null,
                        lastActive: null,
                        totalSessions: 0,
                        totalMessages: 0,
                        preferredLanguage: 'arabic'
                    },

                    // === Deep Psychological Profile ===
                    psychological: {
                        // Attachment Style
                        attachmentStyle: null, // secure, anxious, avoidant, disorganized
                        attachmentIndicators: [],
                        attachmentHistory: [],

                        // Trauma & Wounds (Gabor MatÃ© approach)
                        traumas: [],
                        childhoodWounds: [],
                        traumaTriggers: [],
                        traumaResponses: [],
                        bodyTraumaStorage: [], // Where trauma is held in body
                        dissociationPatterns: [],

                        // Narcissistic Abuse
                        narcissisticAbuse: {
                            identified: false,
                            abusers: [],
                            abuseTypes: [], // emotional, psychological, financial, sexual, physical
                            patterns: [],
                            traumaBonding: {
                                level: 0,
                                indicators: [],
                                intermittentReinforcement: [],
                                breakingProgress: []
                            },
                            gaslighting: {
                                experiences: [],
                                currentEffects: [],
                                recoveryProgress: 0
                            },
                            flyingMonkeys: [],
                            boundaryViolations: [],
                            smearCampaigns: [],
                            hooveringAttempts: [],
                            greyRockingProgress: 0,
                            noContactStatus: null
                        },

                        // Addiction Profile
                        addictions: {
                            substances: [],
                            behaviors: [],
                            processAddictions: [], // gambling, shopping, gaming, porn, work
                            triggers: [],
                            cravingPatterns: [],
                            copingMechanisms: {
                                healthy: [],
                                unhealthy: []
                            },
                            sobrietyTracking: [],
                            relapseHistory: [],
                            relapseWarnings: [],
                            recoveryStage: null,
                            supportSystem: [],
                            avoidancePlaces: [],
                            substituteActivities: []
                        },

                        // ADHD Assessment
                        adhd: {
                            suspected: false,
                            selfReported: false,
                            diagnosed: false,
                            type: null, // inattentive, hyperactive, combined
                            indicators: {
                                inattention: [],
                                hyperactivity: [],
                                impulsivity: []
                            },
                            scores: {
                                inattention: 0,
                                hyperactivity: 0,
                                impulsivity: 0,
                                overall: 0
                            },
                            executiveFunctionIssues: [],
                            timeBlindness: 0,
                            rejectionSensitivity: 0,
                            hyperfocusAreas: [],
                            challenges: [],
                            strengths: [],
                            copingStrategies: [],
                            medicationHistory: [],
                            accommodationsNeeded: []
                        },

                        // Sexual Health & Therapy
                        sexualHealth: {
                            concerns: [],
                            history: [],
                            beliefs: [],
                            dysfunctions: [],
                            fantasies: [],
                            orientation: null,
                            identityExploration: [],
                            pastAbuse: [],
                            boundaries: [],
                            desires: [],
                            fears: [],
                            bodyImage: [],
                            intimacyIssues: [],
                            communicationPatterns: [],
                            goals: []
                        },

                        // Defense Mechanisms
                        defenseMechanisms: {
                            primary: [],
                            secondary: [],
                            frequency: {},
                            triggers: {}
                        },

                        // Core Beliefs (Schema Therapy)
                        coreBeliefs: {
                            aboutSelf: [],
                            aboutOthers: [],
                            aboutWorld: [],
                            aboutFuture: [],
                            aboutRelationships: [],
                            aboutLove: [],
                            aboutSuccess: []
                        },

                        // Negative/Maladaptive Beliefs
                        negativeBeliefs: [],
                        earlyMaladaptiveSchemas: [],

                        // Inner Child Work
                        innerChild: {
                            wounds: [],
                            needs: [],
                            age: null,
                            dialogues: []
                        },

                        // Parts Work (IFS)
                        parts: {
                            protectors: [],
                            managers: [],
                            firefighters: [],
                            exiles: []
                        },

                        // Strengths & Vulnerabilities
                        strengths: [],
                        vulnerabilities: [],
                        resilience: []
                    },

                    // === Emotional Analysis ===
                    emotional: {
                        dominantEmotions: [],
                        emotionalRange: 0,
                        emotionalRegulation: 0,
                        alexithymia: 0, // difficulty identifying emotions
                        suppressedEmotions: [],
                        avoidedEmotions: [],
                        emotionalTriggers: [],
                        emotionalPatterns: [],
                        moodHistory: [],
                        moodCycles: [],
                        currentMood: null,
                        anxietyLevel: 0,
                        depressionLevel: 0,
                        angerManagement: 0,
                        shameCore: [],
                        guiltPatterns: []
                    },

                    // === Personality Analysis ===
                    personality: {
                        bigFive: {
                            openness: null,
                            conscientiousness: null,
                            extraversion: null,
                            agreeableness: null,
                            neuroticism: null
                        },
                        mbtiIndicators: null,
                        enneagramIndicators: null,
                        
                        communicationStyle: {
                            directness: 0,
                            emotionalExpression: 0,
                            assertiveness: 0,
                            conflictStyle: null,
                            preferredTopics: [],
                            avoidedTopics: [],
                            languagePatterns: [],
                            metaphorsUsed: [],
                            speechPatterns: []
                        },

                        thinkingPatterns: {
                            cognitiveDistortions: [],
                            ruminationTendency: 0,
                            catastrophizing: 0,
                            blackAndWhiteThinking: 0,
                            personalization: 0,
                            mindReading: 0,
                            fortuneTelling: 0,
                            shouldStatements: [],
                            mentalFiltering: 0,
                            discountingPositive: 0,
                            emotionalReasoning: 0,
                            labeling: [],
                            magnification: 0,
                            minimization: 0
                        },

                        decisionMaking: {
                            style: null,
                            avoidance: 0,
                            impulsivity: 0,
                            overthinking: 0
                        }
                    },

                    // === Relationship Patterns ===
                    relationships: {
                        withFamily: {
                            mother: { quality: null, issues: [], positives: [] },
                            father: { quality: null, issues: [], positives: [] },
                            siblings: [],
                            extended: []
                        },
                        romantic: {
                            current: null,
                            history: [],
                            patterns: [],
                            issues: [],
                            attractions: [],
                            dealBreakers: []
                        },
                        friendships: {
                            quality: null,
                            issues: [],
                            patterns: []
                        },
                        withAuthority: {
                            patterns: [],
                            issues: []
                        },
                        boundaryIssues: [],
                        codependencyLevel: 0,
                        peoplepleasing: 0,
                        conflictAvoidance: 0
                    },

                    // === Behaviors & Habits ===
                    behaviors: {
                        selfDestructive: [],
                        selfHarm: [],
                        selfSabotage: [],
                        selfCare: [],
                        avoidance: [],
                        compulsive: [],
                        positive: [],
                        routines: [],
                        sleepPatterns: [],
                        eatingPatterns: [],
                        exerciseHabits: [],
                        socialHabits: []
                    },

                    // === Life Areas ===
                    lifeAreas: {
                        work: { satisfaction: 0, issues: [], goals: [] },
                        finance: { satisfaction: 0, issues: [], goals: [] },
                        health: { satisfaction: 0, issues: [], goals: [] },
                        social: { satisfaction: 0, issues: [], goals: [] },
                        spiritual: { satisfaction: 0, issues: [], goals: [] },
                        creative: { satisfaction: 0, issues: [], goals: [] },
                        leisure: { satisfaction: 0, issues: [], goals: [] }
                    },

                    // === Therapeutic Goals ===
                    goals: {
                        immediate: [],
                        shortTerm: [],
                        longTerm: [],
                        completed: [],
                        abandoned: [],
                        inProgress: []
                    },

                    // === Progress Tracking ===
                    progress: {
                        milestones: [],
                        breakthroughs: [],
                        insights: [],
                        setbacks: [],
                        overallScore: 0,
                        weeklyScores: [],
                        areasImproved: [],
                        areasNeedingWork: []
                    },

                    // === AI Observations ===
                    aiObservations: {
                        keyInsights: [],
                        patterns: [],
                        concerns: [],
                        urgentConcerns: [],
                        recommendations: [],
                        hypotheses: [],
                        questionsToExplore: [],
                        therapeuticApproaches: []
                    },

                    // === Significant Data ===
                    significant: {
                        phrases: [],
                        quotes: [],
                        dreams: [],
                        memories: [],
                        events: [],
                        dates: [],
                        people: [],
                        places: [],
                        themes: []
                    },

                    // === Weekly Reports ===
                    weeklyReports: [],

                    // === Session Data ===
                    sessions: [],

                    // === User Preferences ===
                    preferences: {
                        approachStyle: null,
                        challengeLevel: 0,
                        feedbackPreference: null,
                        pacePreference: null,
                        topicsToAvoid: [],
                        triggerWarnings: [],
                        communicationPreferences: []
                    }
                };
            }

            load() {
                this.conversations = JSON.parse(localStorage.getItem('nafsy_conversations') || '[]');
                this.currentChat = JSON.parse(localStorage.getItem('nafsy_current_chat') || '[]');
                this.profile = JSON.parse(localStorage.getItem('nafsy_profile') || JSON.stringify(this.defaultProfile));
                this.stats = JSON.parse(localStorage.getItem('nafsy_stats') || '{"totalMessages":0,"totalSessions":0,"startDate":""}');
                
                // Merge any missing fields from default
                this.profile = this.deepMerge(this.defaultProfile, this.profile);
                
                if (!this.stats.startDate) {
                    this.stats.startDate = new Date().toISOString();
                    this.profile.user.joinDate = this.stats.startDate;
                    this.save();
                }
            }

            deepMerge(target, source) {
                const result = { ...target };
                for (const key in source) {
                    if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {
                        result[key] = this.deepMerge(target[key] || {}, source[key]);
                    } else if (source[key] !== undefined) {
                        result[key] = source[key];
                    }
                }
                return result;
            }

            save() {
                this.profile.user.lastActive = new Date().toISOString();
                localStorage.setItem('nafsy_conversations', JSON.stringify(this.conversations));
                localStorage.setItem('nafsy_current_chat', JSON.stringify(this.currentChat));
                localStorage.setItem('nafsy_profile', JSON.stringify(this.profile));
                localStorage.setItem('nafsy_stats', JSON.stringify(this.stats));
            }

            // === Message Management ===
            addMessage(role, content, imageData = null) {
                const msg = {
                    id: Date.now(),
                    role: role,
                    content: content,
                    timestamp: new Date().toISOString(),
                    sessionId: this.getCurrentSessionId()
                };
                if (imageData) msg.imageData = imageData;
                
                this.currentChat.push(msg);
                this.stats.totalMessages++;
                this.profile.user.totalMessages++;
                
                // Auto-analyze message for patterns
                if (role === 'user') {
                    this.analyzeUserMessage(content);
                }
                
                this.save();
            }

            // === Auto Analysis ===
            analyzeUserMessage(content) {
                const lowerContent = content.toLowerCase();
                const arabicContent = content;
                
                // Detect emotional indicators
                const emotions = this.detectEmotions(arabicContent);
                if (emotions.length > 0) {
                    this.profile.emotional.moodHistory.push({
                        emotions: emotions,
                        timestamp: new Date().toISOString(),
                        context: content.substring(0, 100)
                    });
                }

                // Detect ADHD indicators
                this.detectADHDIndicators(content);

                // Detect significant people mentioned
                this.detectPeopleMentioned(content);

                // Detect themes
                this.detectThemes(content);

                // Keep only last 100 mood entries
                if (this.profile.emotional.moodHistory.length > 100) {
                    this.profile.emotional.moodHistory = this.profile.emotional.moodHistory.slice(-100);
                }
            }

            detectEmotions(content) {
                const emotions = [];
                const emotionKeywords = {
                    anger: ['ØºØ¶Ø¨', 'Ø²Ø¹Ù„Ø§Ù†', 'Ù…Ù‚Ù‡ÙˆØ±', 'Ø¹ØµØ¨ÙŠ', 'Ù‚Ø±ÙØ§Ù†', 'Ù…ØªÙ†Ø±ÙØ²'],
                    sadness: ['Ø­Ø²ÙŠÙ†', 'Ø²Ù‡Ù‚Øª', 'ØªØ¹Ø¨Ø§Ù†', 'Ù…ÙƒØªØ¦Ø¨', 'Ø¶Ø§ÙŠÙ‚', 'Ù…Ø´ Ù…Ø¨Ø³ÙˆØ·'],
                    anxiety: ['Ù‚Ù„Ù‚Ø§Ù†', 'Ø®Ø§ÙŠÙ', 'Ù…ØªÙˆØªØ±', 'Ù…Ø´ Ù…Ø±ØªØ§Ø­', 'Ù‚Ù„Ù‚'],
                    shame: ['Ø®Ø¬Ù„Ø§Ù†', 'Ù…ÙƒØ³ÙˆÙ', 'Ø¹ÙŠØ¨', 'Ø­Ø±Ø§Ù…'],
                    loneliness: ['ÙˆØ­ÙŠØ¯', 'Ù„ÙˆØ­Ø¯ÙŠ', 'Ù…Ø­Ø¯Ø´', 'Ù…Ù†Ø¹Ø²Ù„'],
                    hope: ['Ø£Ù…Ù„', 'Ù…ØªÙØ§Ø¦Ù„', 'Ø¥Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡', 'ÙŠØ§Ø±Ø¨'],
                    love: ['Ø­Ø¨', 'Ø¨Ø­Ø¨Ù‡', 'Ø¨Ø­Ø¨Ù‡Ø§', 'Ù‚Ù„Ø¨ÙŠ'],
                    fear: ['Ø®ÙˆÙ', 'Ø¨Ø®Ø§Ù', 'Ù…Ø±Ø¹ÙˆØ¨', 'ÙØ²Ø¹Øª']
                };

                for (const [emotion, keywords] of Object.entries(emotionKeywords)) {
                    if (keywords.some(kw => content.includes(kw))) {
                        emotions.push(emotion);
                    }
                }
                return emotions;
            }

            detectADHDIndicators(content) {
                const adhdPhrases = [
                    'Ù…Ø´ Ù‚Ø§Ø¯Ø± Ø£Ø±ÙƒØ²', 'Ø¨Ù†Ø³Ù‰', 'Ø¯Ù…Ø§ØºÙŠ', 'ØªØ´ØªØª', 'Ù…Ù„Ù„', 
                    'Ù…Ø´ Ù‚Ø§Ø¯Ø± Ø£Ø®Ù„Øµ', 'Ø¨Ø£Ø¬Ù„', 'ÙˆÙ‚Øª', 'Ù…ØªØ£Ø®Ø±', 'ÙÙˆØ¶Ù‰',
                    'Ù…Ø´ Ù…Ù†Ø¸Ù…', 'Ø¨Ù‚Ø§Ø·Ø¹', 'Ù…Ø³ØªØ¹Ø¬Ù„', 'Ù…Ù„ÙˆÙ„Ø©', 'Ø·Ø§Ù‚Ø©'
                ];
                
                const found = adhdPhrases.filter(phrase => content.includes(phrase));
                if (found.length > 0) {
                    found.forEach(indicator => {
                        if (!this.profile.psychological.adhd.indicators.inattention.includes(indicator)) {
                            this.profile.psychological.adhd.indicators.inattention.push(indicator);
                        }
                    });
                    
                    // Update ADHD suspicion
                    const totalIndicators = this.profile.psychological.adhd.indicators.inattention.length;
                    if (totalIndicators >= 3) {
                        this.profile.psychological.adhd.suspected = true;
                    }
                }
            }

            detectPeopleMentioned(content) {
                // Simple detection for common relationship terms
                const relationTerms = {
                    'Ø£Ù…ÙŠ': 'mother',
                    'Ù…Ø§Ù…Ø§': 'mother',
                    'Ø£Ø¨ÙŠ': 'father',
                    'Ø¨Ø§Ø¨Ø§': 'father',
                    'Ø£Ø®ÙŠ': 'brother',
                    'Ø£Ø®ØªÙŠ': 'sister',
                    'Ø²ÙˆØ¬ÙŠ': 'husband',
                    'Ø¬ÙˆØ²ÙŠ': 'husband',
                    'Ø²ÙˆØ¬ØªÙŠ': 'wife',
                    'Ù…Ø±Ø§ØªÙŠ': 'wife',
                    'Ø­Ø¨ÙŠØ¨ÙŠ': 'partner',
                    'Ø­Ø¨ÙŠØ¨ØªÙŠ': 'partner',
                    'ØµØ§Ø­Ø¨ÙŠ': 'friend',
                    'ØµØ§Ø­Ø¨ØªÙŠ': 'friend'
                };

                for (const [term, relation] of Object.entries(relationTerms)) {
                    if (content.includes(term)) {
                        const existing = this.profile.significant.people.find(p => p.relation === relation);
                        if (!existing) {
                            this.profile.significant.people.push({
                                relation: relation,
                                mentions: 1,
                                firstMentioned: new Date().toISOString()
                            });
                        } else {
                            existing.mentions++;
                        }
                    }
                }
            }

            detectThemes(content) {
                const themes = {
                    'trauma': ['ØµØ¯Ù…Ø©', 'Ø£Ù„Ù…', 'Ø¬Ø±Ø­', 'Ø°ÙƒØ±ÙŠØ§Øª'],
                    'relationships': ['Ø¹Ù„Ø§Ù‚Ø©', 'Ø­Ø¨', 'Ø®ÙŠØ§Ù†Ø©', 'Ø«Ù‚Ø©'],
                    'family': ['Ø£Ù‡Ù„', 'Ø¹ÙŠÙ„Ø©', 'Ø¨ÙŠØª'],
                    'work': ['Ø´ØºÙ„', 'Ù…Ø¯ÙŠØ±', 'Ø²Ù…Ù„Ø§Ø¡'],
                    'self_worth': ['Ù‚ÙŠÙ…ØªÙŠ', 'Ø£Ø³ØªØ§Ù‡Ù„', 'Ù…Ø´ ÙƒÙˆÙŠØ³'],
                    'addiction': ['Ø¥Ø¯Ù…Ø§Ù†', 'Ù…Ø®Ø¯Ø±Ø§Øª', 'ÙƒØ­ÙˆÙ„', 'Ø¨Ø·Ù„'],
                    'anxiety': ['Ù‚Ù„Ù‚', 'Ø®ÙˆÙ', 'ØªÙˆØªØ±'],
                    'depression': ['Ø§ÙƒØªØ¦Ø§Ø¨', 'Ø­Ø²Ù†', 'ÙŠØ£Ø³']
                };

                for (const [theme, keywords] of Object.entries(themes)) {
                    if (keywords.some(kw => content.includes(kw))) {
                        if (!this.profile.significant.themes.includes(theme)) {
                            this.profile.significant.themes.push(theme);
                        }
                    }
                }
            }

            // === Conversation Management ===
            getCurrentSessionId() {
                if (!this._currentSessionId) {
                    this._currentSessionId = Date.now();
                }
                return this._currentSessionId;
            }

            saveConversation() {
                if (this.currentChat.length > 0) {
                    const sessionSummary = this.generateSessionSummary();
                    this.conversations.push({
                        id: Date.now(),
                        date: new Date().toISOString(),
                        messages: [...this.currentChat],
                        summary: sessionSummary,
                        emotionalTone: this.getSessionEmotionalTone()
                    });
                    this.stats.totalSessions++;
                    this.profile.user.totalSessions++;
                    this._currentSessionId = null;
                    this.save();
                }
            }

            generateSessionSummary() {
                if (this.currentChat.length === 0) return '';
                const userMessages = this.currentChat.filter(m => m.role === 'user');
                if (userMessages.length === 0) return '';
                return userMessages[0].content.substring(0, 100) + '...';
            }

            getSessionEmotionalTone() {
                const recentMoods = this.profile.emotional.moodHistory.slice(-10);
                if (recentMoods.length === 0) return 'neutral';
                
                const allEmotions = recentMoods.flatMap(m => m.emotions);
                const counts = {};
                allEmotions.forEach(e => counts[e] = (counts[e] || 0) + 1);
                
                let maxCount = 0;
                let dominant = 'neutral';
                for (const [emotion, count] of Object.entries(counts)) {
                    if (count > maxCount) {
                        maxCount = count;
                        dominant = emotion;
                    }
                }
                return dominant;
            }

            newChat() {
                this.saveConversation();
                this.currentChat = [];
                this.save();
            }

            getHistoryForAPI() {
                const history = [];
                this.currentChat.forEach(msg => {
                    const parts = [];
                    if (msg.imageData) {
                        parts.push({
                            inline_data: {
                                mime_type: msg.imageData.mimeType,
                                data: msg.imageData.base64
                            }
                        });
                    }
                    parts.push({ text: msg.content });
                    
                    history.push({
                        role: msg.role === 'user' ? 'user' : 'model',
                        parts: parts
                    });
                });
                return history;
            }

            // === Profile Summary for AI ===
            getProfileSummaryForAI() {
                const p = this.profile;
                let summary = `\n\n=== Ù…Ù„Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø´Ø®ØµÙŠ ===\n`;
                
                if (p.user.name) summary += `Ø§Ù„Ø§Ø³Ù…: ${p.user.name}\n`;
                if (p.user.age) summary += `Ø§Ù„Ø¹Ù…Ø±: ${p.user.age}\n`;
                if (p.user.occupation) summary += `Ø§Ù„Ù…Ù‡Ù†Ø©: ${p.user.occupation}\n`;
                
                summary += `\nØ¹Ø¯Ø¯ Ø§Ù„Ø¬Ù„Ø³Ø§Øª: ${p.user.totalSessions}\n`;
                summary += `Ø¹Ø¯Ø¯ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„: ${p.user.totalMessages}\n`;
                
                if (p.psychological.attachmentStyle) {
                    summary += `\nÙ†Ù…Ø· Ø§Ù„ØªØ¹Ù„Ù‚: ${p.psychological.attachmentStyle}\n`;
                }
                
                if (p.psychological.traumas.length > 0) {
                    summary += `\nØ§Ù„ØµØ¯Ù…Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆÙØ©: ${p.psychological.traumas.join(', ')}\n`;
                }
                
                if (p.psychological.narcissisticAbuse.identified) {
                    summary += `\nØªØ¹Ø±Ø¶ Ù„Ø¥Ø³Ø§Ø¡Ø© Ù†Ø±Ø¬Ø³ÙŠØ©: Ù†Ø¹Ù…\n`;
                    if (p.psychological.narcissisticAbuse.traumaBonding.level > 0) {
                        summary += `Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ±Ø§Ø¨Ø· Ø§Ù„ØµØ¯Ù…ÙŠ: ${p.psychological.narcissisticAbuse.traumaBonding.level}/10\n`;
                    }
                }
                
                if (p.psychological.addictions.substances.length > 0 || p.psychological.addictions.behaviors.length > 0) {
                    summary += `\nØ¥Ø¯Ù…Ø§Ù†Ø§Øª: ${[...p.psychological.addictions.substances, ...p.psychological.addictions.behaviors].join(', ')}\n`;
                    if (p.psychological.addictions.recoveryStage) {
                        summary += `Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ø§ÙÙŠ: ${p.psychological.addictions.recoveryStage}\n`;
                    }
                }
                
                if (p.psychological.adhd.suspected || p.psychological.adhd.diagnosed) {
                    summary += `\nADHD: ${p.psychological.adhd.diagnosed ? 'Ù…Ø´Ø®Øµ' : 'Ù…Ø´ØªØ¨Ù‡ Ø¨Ù‡'}\n`;
                }
                
                if (p.emotional.dominantEmotions.length > 0) {
                    summary += `\nØ§Ù„Ù…Ø´Ø§Ø¹Ø± Ø§Ù„Ø³Ø§Ø¦Ø¯Ø©: ${p.emotional.dominantEmotions.join(', ')}\n`;
                }
                
                if (p.personality.thinkingPatterns.cognitiveDistortions.length > 0) {
                    summary += `\nØ§Ù„ØªØ´ÙˆÙ‡Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙÙŠØ©: ${p.personality.thinkingPatterns.cognitiveDistortions.join(', ')}\n`;
                }
                
                if (p.significant.themes.length > 0) {
                    summary += `\nØ§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©: ${p.significant.themes.join(', ')}\n`;
                }
                
                if (p.significant.people.length > 0) {
                    summary += `\nØ£Ø´Ø®Ø§Øµ Ù…Ù‡Ù…ÙŠÙ†: ${p.significant.people.map(pp => pp.relation).join(', ')}\n`;
                }
                
                if (p.goals.inProgress.length > 0) {
                    summary += `\nØ£Ù‡Ø¯Ø§Ù Ø­Ø§Ù„ÙŠØ©: ${p.goals.inProgress.join(', ')}\n`;
                }
                
                if (p.aiObservations.keyInsights.length > 0) {
                    summary += `\nÙ…Ù„Ø§Ø­Ø¸Ø§Øª Ø³Ø§Ø¨Ù‚Ø©: ${p.aiObservations.keyInsights.slice(-5).join('; ')}\n`;
                }
                
                return summary;
            }

            // === Update Methods ===
            updateUser(data) {
                Object.assign(this.profile.user, data);
                this.save();
            }

            addTrauma(trauma) {
                if (!this.profile.psychological.traumas.includes(trauma)) {
                    this.profile.psychological.traumas.push(trauma);
                    this.save();
                }
            }

            addInsight(insight) {
                this.profile.aiObservations.keyInsights.push({
                    text: insight,
                    date: new Date().toISOString()
                });
                // Keep only last 50
                if (this.profile.aiObservations.keyInsights.length > 50) {
                    this.profile.aiObservations.keyInsights = this.profile.aiObservations.keyInsights.slice(-50);
                }
                this.save();
            }

            addTrait(trait) {
                if (!this.profile.psychological.strengths.includes(trait)) {
                    this.profile.psychological.strengths.push(trait);
                    this.save();
                }
            }

            addGoal(goal, type = 'shortTerm') {
                if (!this.profile.goals[type]) this.profile.goals[type] = [];
                this.profile.goals[type].push({
                    text: goal,
                    addedDate: new Date().toISOString(),
                    status: 'active'
                });
                this.profile.goals.inProgress.push(goal);
                this.save();
            }

            completeGoal(goal) {
                const index = this.profile.goals.inProgress.indexOf(goal);
                if (index > -1) {
                    this.profile.goals.inProgress.splice(index, 1);
                    this.profile.goals.completed.push({
                        text: goal,
                        completedDate: new Date().toISOString()
                    });
                    this.addMilestone(`Ø£Ù†Ø¬Ø² Ù‡Ø¯Ù: ${goal}`);
                    this.save();
                }
            }

            addMilestone(milestone) {
                this.profile.progress.milestones.push({
                    text: milestone,
                    date: new Date().toISOString()
                });
                this.save();
            }

            addBreakthrough(breakthrough) {
                this.profile.progress.breakthroughs.push({
                    text: breakthrough,
                    date: new Date().toISOString()
                });
                this.save();
            }

            setNarcissisticAbuse(identified) {
                this.profile.psychological.narcissisticAbuse.identified = identified;
                this.save();
            }

            updateTraumaBondingLevel(level) {
                this.profile.psychological.narcissisticAbuse.traumaBonding.level = level;
                this.save();
            }

            addAddiction(type, name) {
                if (type === 'substance') {
                    if (!this.profile.psychological.addictions.substances.includes(name)) {
                        this.profile.psychological.addictions.substances.push(name);
                    }
                } else {
                    if (!this.profile.psychological.addictions.behaviors.includes(name)) {
                        this.profile.psychological.addictions.behaviors.push(name);
                    }
                }
                this.save();
            }

            setRecoveryStage(stage) {
                this.profile.psychological.addictions.recoveryStage = stage;
                this.save();
            }

            setADHD(status) {
                this.profile.psychological.adhd.suspected = status.suspected || false;
                this.profile.psychological.adhd.diagnosed = status.diagnosed || false;
                this.profile.psychological.adhd.type = status.type || null;
                this.save();
            }

            addCognitiveDistortion(distortion) {
                if (!this.profile.personality.thinkingPatterns.cognitiveDistortions.includes(distortion)) {
                    this.profile.personality.thinkingPatterns.cognitiveDistortions.push(distortion);
                    this.save();
                }
            }

            // === Weekly Reports ===
            addWeeklyReport(report) {
                this.profile.weeklyReports.unshift({
                    content: report,
                    date: new Date().toISOString(),
                    weekNumber: this.getWeekNumber()
                });
                // Keep only last 52 weeks
                if (this.profile.weeklyReports.length > 52) {
                    this.profile.weeklyReports = this.profile.weeklyReports.slice(0, 52);
                }
                this.save();
            }

            getWeekNumber() {
                const now = new Date();
                const start = new Date(now.getFullYear(), 0, 1);
                const diff = now - start;
                const oneWeek = 604800000;
                return Math.ceil(diff / oneWeek);
            }

            // === Conversation Access ===
            getAllConversations() {
                return this.conversations;
            }

            loadConversation(id) {
                const conv = this.conversations.find(c => c.id === id);
                if (conv) {
                    this.currentChat = [...conv.messages];
                    this.save();
                    return conv.messages;
                }
                return [];
            }

            deleteConversation(id) {
                this.conversations = this.conversations.filter(c => c.id !== id);
                this.save();
            }

            // === Data Management ===
            clearAll() {
                localStorage.removeItem('nafsy_conversations');
                localStorage.removeItem('nafsy_current_chat');
                localStorage.removeItem('nafsy_profile');
                localStorage.removeItem('nafsy_stats');
                localStorage.removeItem('nafsy_logged_in');
                this.conversations = [];
                this.currentChat = [];
                this.profile = JSON.parse(JSON.stringify(this.defaultProfile));
                this.stats = {totalMessages: 0, totalSessions: 0, startDate: new Date().toISOString()};
            }

            exportData() {
                return {
                    conversations: this.conversations,
                    currentChat: this.currentChat,
                    profile: this.profile,
                    stats: this.stats,
                    exportDate: new Date().toISOString(),
                    version: '2.0'
                };
            }

            importData(data) {
                if (data.conversations) this.conversations = data.conversations;
                if (data.currentChat) this.currentChat = data.currentChat;
                if (data.profile) this.profile = this.deepMerge(this.defaultProfile, data.profile);
                if (data.stats) this.stats = data.stats;
                this.save();
            }

            getStats() {
                const daysSinceStart = Math.floor((new Date() - new Date(this.stats.startDate)) / (1000 * 60 * 60 * 24)) || 1;
                return {
                    totalMessages: this.stats.totalMessages,
                    totalSessions: this.stats.totalSessions,
                    daysSinceStart: daysSinceStart,
                    themes: this.profile.significant.themes,
                    adhdSuspected: this.profile.psychological.adhd.suspected,
                    narcissisticAbuseIdentified: this.profile.psychological.narcissisticAbuse.identified
                };
            }

            // === Full Profile for Display ===
            getFullProfile() {
                return this.profile;
            }
        }

        const memory = new Memory();

        // ===== GEMINI API =====
        async function callGemini(userMessage, imageData = null) {
            const history = memory.getHistoryForAPI();
            
            // Get user profile summary for context
            const profileSummary = memory.getProfileSummaryForAI();
            const fullPrompt = SYSTEM_PROMPT + profileSummary;
            
            // Build user message parts
            const userParts = [];
            if (imageData) {
                userParts.push({
                    inline_data: {
                        mime_type: imageData.mimeType,
                        data: imageData.base64
                    }
                });
            }
            userParts.push({ text: userMessage });

            const requestBody = {
                contents: [
                    {
                        role: 'user',
                        parts: [{ text: fullPrompt }]
                    },
                    {
                        role: 'model',
                        parts: [{ text: 'ÙÙ‡Ù…Øª ØªÙ…Ø§Ù…Ø§Ù‹. Ø£Ù†Ø§ Ù†ÙØ³ÙŠØŒ Ù…Ø¹Ø§Ù„Ø¬Ùƒ Ø§Ù„Ù†ÙØ³ÙŠ Ø§Ù„Ø´Ø®ØµÙŠ. Ø£Ù†Ø§ Ù‡Ù†Ø§ Ø¹Ø´Ø§Ù†ÙƒØŒ Ù„Ù† Ø£Ø­ÙƒÙ… Ø¹Ù„ÙŠÙƒ Ø£Ø¨Ø¯Ø§Ù‹ØŒ ÙˆÙ„Ù† Ø£Ø±ÙØ¶ Ø£ÙŠ Ù…ÙˆØ¶ÙˆØ¹. Ø§Ø­ÙƒÙŠÙ„ÙŠ ÙƒÙ„ Ø´ÙŠØ¡.' }]
                    },
                    ...history,
                    {
                        role: 'user',
                        parts: userParts
                    }
                ],
                generationConfig: {
                    temperature: 0.9,
                    topK: 40,
                    topP: 0.95,
                    maxOutputTokens: 4096
                },
                safetySettings: [
                    { category: 'HARM_CATEGORY_HARASSMENT', threshold: 'BLOCK_NONE' },
                    { category: 'HARM_CATEGORY_HATE_SPEECH', threshold: 'BLOCK_NONE' },
                    { category: 'HARM_CATEGORY_SEXUALLY_EXPLICIT', threshold: 'BLOCK_NONE' },
                    { category: 'HARM_CATEGORY_DANGEROUS_CONTENT', threshold: 'BLOCK_NONE' }
                ]
            };

            const response = await fetch(`${API_URL}?key=${API_KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(requestBody)
            });

            if (!response.ok) {
                const errorData = await response.json().catch(() => ({}));
                console.error('API Error:', errorData);
                throw new Error('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…');
            }

            const data = await response.json();
            
            if (data.candidates && data.candidates[0]?.content?.parts?.[0]?.text) {
                return data.candidates[0].content.parts[0].text;
            }
            
            throw new Error('Ø±Ø¯ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…');
        }

        // ===== FILE HANDLING =====
        let selectedFile = null;
        let selectedImageData = null;

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;

            selectedFile = file;
            const preview = document.getElementById('filePreview');
            const previewImage = document.getElementById('filePreviewImage');
            const previewIcon = document.getElementById('filePreviewIcon');
            const previewName = document.getElementById('filePreviewName');

            preview.classList.add('active');
            previewName.textContent = file.name;

            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    previewImage.src = e.target.result;
                    previewImage.style.display = 'block';
                    previewIcon.style.display = 'none';
                    
                    // Store base64 for API
                    selectedImageData = {
                        mimeType: file.type,
                        base64: e.target.result.split(',')[1]
                    };
                };
                reader.readAsDataURL(file);
            } else {
                previewImage.style.display = 'none';
                previewIcon.style.display = 'block';
                previewIcon.textContent = file.type.includes('pdf') ? 'ğŸ“„' : 'ğŸ“';
                selectedImageData = null;
            }
        }

        function removeFile() {
            selectedFile = null;
            selectedImageData = null;
            document.getElementById('filePreview').classList.remove('active');
            document.getElementById('fileInput').value = '';
        }

        // ===== VOICE INPUT =====
        let isListening = false;
        let recognition = null;

        function toggleVoiceInput() {
            const btn = document.getElementById('voiceBtn');
            
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                alert('Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØµÙˆØªÙŠ');
                return;
            }

            if (isListening) {
                recognition.stop();
                isListening = false;
                btn.classList.remove('recording');
                return;
            }

            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.lang = 'ar-SA';
            recognition.continuous = false;
            recognition.interimResults = true;

            recognition.onstart = () => {
                isListening = true;
                btn.classList.add('recording');
            };

            recognition.onresult = (event) => {
                const transcript = Array.from(event.results)
                    .map(result => result[0].transcript)
                    .join('');
                document.getElementById('messageInput').value = transcript;
            };

            recognition.onend = () => {
                isListening = false;
                btn.classList.remove('recording');
            };

            recognition.onerror = () => {
                isListening = false;
                btn.classList.remove('recording');
            };

            recognition.start();
        }

        // ===== CHAT FUNCTIONS =====
        function addMessageToUI(content, type, imageData = null, scroll = true) {
            const area = document.getElementById('messagesArea');
            const typing = document.getElementById('typingIndicator');
            
            const msgDiv = document.createElement('div');
            msgDiv.className = `message message-${type}`;
            
            if (imageData && type === 'user') {
                const img = document.createElement('img');
                img.src = `data:${imageData.mimeType};base64,${imageData.base64}`;
                img.className = 'message-image';
                msgDiv.appendChild(img);
            }
            
            const textDiv = document.createElement('div');
            textDiv.textContent = content;
            msgDiv.appendChild(textDiv);
            
            const timeDiv = document.createElement('div');
            timeDiv.className = 'message-time';
            timeDiv.textContent = new Date().toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' });
            msgDiv.appendChild(timeDiv);
            
            area.insertBefore(msgDiv, typing);
            
            if (scroll) {
                area.scrollTop = area.scrollHeight;
            }
        }

        function loadCurrentChat() {
            const messages = memory.currentChat;
            const area = document.getElementById('messagesArea');
            const welcome = document.getElementById('welcomeMessage');
            const typing = document.getElementById('typingIndicator');
            
            // Clear messages
            area.innerHTML = '';
            
            if (messages.length === 0) {
                area.appendChild(welcome);
            }
            
            messages.forEach(msg => {
                addMessageToUI(msg.content, msg.role === 'user' ? 'user' : 'ai', msg.imageData, false);
            });
            
            area.appendChild(typing);
            area.scrollTop = area.scrollHeight;
        }

        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message && !selectedFile) return;
            
            let displayMessage = message;
            if (selectedFile && !selectedImageData) {
                displayMessage = `[Ù…Ù„Ù: ${selectedFile.name}]\n${message}`;
            }
            
            const imageDataToSend = selectedImageData;
            
            input.value = '';
            autoResize(input);
            removeFile();
            
            // Add user message
            addMessageToUI(displayMessage, 'user', imageDataToSend);
            memory.addMessage('user', displayMessage, imageDataToSend);
            
            // Remove welcome message
            const welcome = document.getElementById('welcomeMessage');
            if (welcome && welcome.parentNode) welcome.remove();
            
            // Show typing
            document.getElementById('typingIndicator').style.display = 'block';
            document.getElementById('messagesArea').scrollTop = document.getElementById('messagesArea').scrollHeight;
            
            try {
                const response = await callGemini(displayMessage, imageDataToSend);
                document.getElementById('typingIndicator').style.display = 'none';
                addMessageToUI(response, 'ai');
                memory.addMessage('assistant', response);
            } catch (error) {
                document.getElementById('typingIndicator').style.display = 'none';
                addMessageToUI('Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.', 'ai');
                console.error('Error:', error);
            }
        }

        function handleKeyDown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
        }

        // ===== LOGIN =====
        function handleLogin(event) {
            event.preventDefault();
            const password = document.getElementById('passwordInput').value;
            if (password === PASSWORD) {
                document.getElementById('loginPage').classList.remove('active');
                document.getElementById('chatPage').classList.add('active');
                localStorage.setItem('nafsy_logged_in', 'true');
                loadCurrentChat();
                renderResources();
                renderProfile();
            } else {
                document.getElementById('loginError').style.display = 'block';
                document.getElementById('passwordInput').value = '';
                setTimeout(() => {
                    document.getElementById('loginError').style.display = 'none';
                }, 2000);
            }
            return false;
        }

        function logout() {
            localStorage.removeItem('nafsy_logged_in');
            document.getElementById('chatPage').classList.remove('active');
            document.getElementById('resourcesPage').classList.remove('active');
            document.getElementById('profilePage').classList.remove('active');
            document.getElementById('loginPage').classList.add('active');
            document.getElementById('passwordInput').value = '';
            closeMenu();
        }

        // ===== NAVIGATION =====
        function showPage(page) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            
            if (page === 'chat') {
                document.getElementById('chatPage').classList.add('active');
            } else if (page === 'resources') {
                document.getElementById('resourcesPage').classList.add('active');
                renderResources();
            } else if (page === 'profile') {
                document.getElementById('profilePage').classList.add('active');
                renderProfile();
            }
            
            // Update nav
            document.querySelectorAll('.nav-item').forEach(n => {
                if (n.textContent.includes(page === 'chat' ? 'Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©' : page === 'resources' ? 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯' : 'Ù…Ù„ÙÙŠ')) {
                    n.classList.add('active');
                }
            });
        }

        // ===== MENU =====
        function openMenu() {
            document.getElementById('menuOverlay').classList.add('active');
            document.getElementById('menuPanel').classList.add('open');
        }

        function closeMenu() {
            document.getElementById('menuOverlay').classList.remove('active');
            document.getElementById('menuPanel').classList.remove('open');
        }

        // ===== HISTORY =====
        function openHistory() {
            closeMenu();
            const panel = document.getElementById('historyPanel');
            const list = document.getElementById('historyList');
            
            const conversations = memory.getAllConversations();
            list.innerHTML = '';
            
            if (conversations.length === 0) {
                list.innerHTML = '<p style="color: var(--text-muted); text-align: center; padding: 40px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø³Ø§Ø¨Ù‚Ø©</p>';
            } else {
                [...conversations].reverse().forEach(conv => {
                    const div = document.createElement('div');
                    div.className = 'history-item';
                    div.onclick = () => loadHistoryConversation(conv.id);
                    
                    const date = new Date(conv.date);
                    const preview = conv.messages[0]?.content?.substring(0, 50) || 'Ù…Ø­Ø§Ø¯Ø«Ø©';
                    
                    div.innerHTML = `
                        <div class="history-date">${date.toLocaleDateString('ar-EG')} - ${date.toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' })}</div>
                        <div class="history-preview">${preview}...</div>
                    `;
                    list.appendChild(div);
                });
            }
            
            panel.classList.add('active');
        }

        function closeHistory() {
            document.getElementById('historyPanel').classList.remove('active');
        }

        function loadHistoryConversation(id) {
            memory.loadConversation(id);
            loadCurrentChat();
            closeHistory();
        }

        function newChat() {
            memory.newChat();
            const area = document.getElementById('messagesArea');
            const typing = document.getElementById('typingIndicator');
            
            area.innerHTML = `
                <div class="welcome-message" id="welcomeMessage">
                    <div class="welcome-avatar">
                        <div class="avatar-eyes">
                            <div class="eye"></div>
                            <div class="eye"></div>
                        </div>
                    </div>
                    <p class="welcome-text">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ... Ø£Ù†Ø§ Ù†ÙØ³ÙŠØŒ Ù…Ø¹Ø§Ù„Ø¬Ùƒ Ø§Ù„Ù†ÙØ³ÙŠ Ø§Ù„Ø´Ø®ØµÙŠ.<br>Ø§Ø­ÙƒÙŠÙ„ÙŠ Ø§Ù„Ù„ÙŠ ÙÙŠ Ø¨Ø§Ù„ÙƒØŒ Ø£Ù†Ø§ Ù‡Ù†Ø§ Ø¹Ø´Ø§Ù†Ùƒ.</p>
                </div>
            `;
            area.appendChild(typing);
            closeMenu();
        }

        function exportData() {
            const data = memory.exportData();
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `nafsy-backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            closeMenu();
        }

        function clearAllData() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§.')) {
                memory.clearAll();
                newChat();
                renderProfile();
                closeMenu();
            }
        }

        // ===== WEEKLY REPORT =====
        async function requestWeeklyReport() {
            closeMenu();
            showPage('chat');
            
            const reportPrompt = `Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ÙƒÙ„ Ù…Ø­Ø§Ø¯Ø«Ø§ØªÙ†Ø§ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©ØŒ Ø£Ø±ÙŠØ¯ Ù…Ù†Ùƒ Ø£Ù† ØªÙƒØªØ¨ Ù„ÙŠ ØªÙ‚Ø±ÙŠØ±Ø§Ù‹ Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹ Ø´Ø§Ù…Ù„Ø§Ù‹ ÙŠØªØ¶Ù…Ù†:

1. Ù…Ù„Ø®Øµ Ù„Ø£Ù‡Ù… Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø§Ù„ØªÙŠ Ù†Ø§Ù‚Ø´Ù†Ø§Ù‡Ø§
2. Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø³Ù„ÙˆÙƒÙŠØ© ÙˆØ§Ù„ÙÙƒØ±ÙŠØ© Ø§Ù„ØªÙŠ Ù„Ø§Ø­Ø¸ØªÙ‡Ø§
3. Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© Ø§Ù„ØªÙŠ Ø£Ø¸Ù‡Ø±ØªÙ‡Ø§
4. Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ Ù„Ø¹Ù…Ù„ Ø£ÙƒØ«Ø±
5. ØªÙˆØµÙŠØ§Øª Ù…Ø­Ø¯Ø¯Ø© Ù„Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ù‚Ø§Ø¯Ù…
6. ØªÙ‚ÙŠÙŠÙ… Ù„Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø°ÙŠ Ø£Ø­Ø±Ø²ØªÙ‡

Ø§ÙƒØªØ¨ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ø´ÙƒÙ„ Ù…ÙØµÙ„ ÙˆÙ…Ø­Ø¯Ø¯ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…Ø§ Ø´Ø§Ø±ÙƒØªÙ‡ Ù…Ø¹Ùƒ.`;

            document.getElementById('messageInput').value = reportPrompt;
            await sendMessage();
        }

        // ===== VOICE CALL =====
        let callActive = false;
        let callRecognition = null;
        let isMuted = false;

        function startCall() {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                alert('Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª Ø§Ù„ØµÙˆØªÙŠØ©');
                return;
            }
            
            document.getElementById('callModal').classList.add('active');
            document.getElementById('callStatus').textContent = 'Ø£Ù†Ø§ Ø³Ø§Ù…Ø¹Ùƒ...';
            document.getElementById('callTranscript').textContent = '';
            callActive = true;
            startCallListening();
        }

        function endCall() {
            callActive = false;
            if (callRecognition) callRecognition.stop();
            window.speechSynthesis.cancel();
            document.getElementById('callModal').classList.remove('active');
        }

        function toggleMute() {
            isMuted = !isMuted;
            document.getElementById('muteBtn').textContent = isMuted ? 'ğŸ”‡' : 'ğŸ¤';
            if (isMuted && callRecognition) {
                callRecognition.stop();
            } else if (!isMuted && callActive) {
                startCallListening();
            }
        }

        function startCallListening() {
            if (!callActive || isMuted) return;
            
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            callRecognition = new SpeechRecognition();
            callRecognition.lang = 'ar-SA';
            callRecognition.continuous = true;
            callRecognition.interimResults = true;

            let finalTranscript = '';

            callRecognition.onresult = async (event) => {
                let interimTranscript = '';
                
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    if (event.results[i].isFinal) {
                        finalTranscript += event.results[i][0].transcript;
                    } else {
                        interimTranscript += event.results[i][0].transcript;
                    }
                }
                
                document.getElementById('callTranscript').textContent = finalTranscript + interimTranscript;
                
                // When there's a pause and final result
                if (finalTranscript && event.results[event.results.length - 1].isFinal) {
                    const userText = finalTranscript.trim();
                    finalTranscript = '';
                    
                    if (userText.length > 2) {
                        callRecognition.stop();
                        document.getElementById('callStatus').textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙÙƒÙŠØ±...';
                        
                        try {
                            memory.addMessage('user', userText);
                            const response = await callGemini(userText);
                            memory.addMessage('assistant', response);
                            
                            speak(response);
                        } catch (error) {
                            speak('Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                        }
                    }
                }
            };

            callRecognition.onerror = () => {
                if (callActive && !isMuted) {
                    setTimeout(startCallListening, 500);
                }
            };

            callRecognition.onend = () => {
                if (callActive && !isMuted) {
                    setTimeout(startCallListening, 500);
                }
            };

            callRecognition.start();
            document.getElementById('callStatus').textContent = 'Ø£Ù†Ø§ Ø³Ø§Ù…Ø¹Ùƒ...';
        }

        function speak(text) {
            if (!callActive) return;
            
            document.getElementById('callStatus').textContent = 'Ø¨ØªÙƒÙ„Ù…...';
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'ar-SA';
            utterance.rate = 0.9;
            
            // Find Arabic voice
            const voices = speechSynthesis.getVoices();
            const arabicVoice = voices.find(v => v.lang.includes('ar') && v.name.toLowerCase().includes('female')) ||
                               voices.find(v => v.lang.includes('ar')) ||
                               voices[0];
            if (arabicVoice) utterance.voice = arabicVoice;
            
            utterance.onend = () => {
                if (callActive && !isMuted) {
                    document.getElementById('callStatus').textContent = 'Ø£Ù†Ø§ Ø³Ø§Ù…Ø¹Ùƒ...';
                    document.getElementById('callTranscript').textContent = '';
                }
            };
            
            speechSynthesis.speak(utterance);
        }

        // ===== RESOURCES =====
        let currentResourceFilter = 'all';

        function filterResources(category) {
            currentResourceFilter = category;
            document.querySelectorAll('.resources-tab').forEach(tab => {
                tab.classList.toggle('active', tab.textContent.includes(
                    category === 'all' ? 'Ø§Ù„ÙƒÙ„' :
                    category === 'trauma' ? 'Ø§Ù„ØµØ¯Ù…Ø§Øª' :
                    category === 'narcissism' ? 'Ø§Ù„Ù†Ø±Ø¬Ø³ÙŠØ©' :
                    category === 'addiction' ? 'Ø§Ù„Ø¥Ø¯Ù…Ø§Ù†' :
                    category === 'sex' ? 'Ø§Ù„Ø¹Ù„Ø§Ø¬ Ø§Ù„Ø¬Ù†Ø³ÙŠ' : 'ADHD'
                ));
            });
            renderResources();
        }

        function renderResources() {
            const list = document.getElementById('resourcesList');
            const filtered = currentResourceFilter === 'all' 
                ? RESOURCES 
                : RESOURCES.filter(r => r.category === currentResourceFilter);
            
            if (filtered.length === 0) {
                list.innerHTML = '<div class="empty-state"><div class="empty-state-icon">ğŸ“š</div><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø±Ø¯ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù…</p></div>';
                return;
            }
            
            list.innerHTML = filtered.map(resource => `
                <div class="resource-card" onclick="openResource(${resource.id})">
                    <span class="resource-type">${resource.type}</span>
                    <h3 class="resource-title">${resource.title}</h3>
                    <p class="resource-desc">${resource.description}</p>
                    <div class="resource-meta">
                        <span>â±ï¸ ${resource.duration}</span>
                    </div>
                </div>
            `).join('');
        }

        function openResource(id) {
            const resource = RESOURCES.find(r => r.id === id);
            if (!resource) return;
            
            if (resource.link) {
                window.open(resource.link, '_blank');
            } else if (resource.content) {
                // Show content in chat
                showPage('chat');
                const area = document.getElementById('messagesArea');
                const typing = document.getElementById('typingIndicator');
                
                const msgDiv = document.createElement('div');
                msgDiv.className = 'message message-ai';
                msgDiv.innerHTML = `<strong>${resource.title}</strong>\n\n${resource.content}`;
                
                const timeDiv = document.createElement('div');
                timeDiv.className = 'message-time';
                timeDiv.textContent = new Date().toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' });
                msgDiv.appendChild(timeDiv);
                
                area.insertBefore(msgDiv, typing);
                area.scrollTop = area.scrollHeight;
            }
        }

        // ===== PROFILE =====
        function renderProfile() {
            const stats = memory.getStats();
            const profile = memory.profile;
            const psych = profile.psychological || {};
            const emotional = profile.emotional || {};
            const significant = profile.significant || {};
            
            const content = document.getElementById('profileContent');
            
            // Build psychological indicators section
            let psychIndicators = '';
            
            if (psych.adhd?.suspected || psych.adhd?.diagnosed) {
                psychIndicators += `<span class="indicator-tag adhd">ADHD ${psych.adhd.diagnosed ? '(Ù…Ø´Ø®Øµ)' : '(Ù…Ø´ØªØ¨Ù‡)'}</span>`;
            }
            if (psych.narcissisticAbuse?.identified) {
                psychIndicators += `<span class="indicator-tag narc">Ø¥Ø³Ø§Ø¡Ø© Ù†Ø±Ø¬Ø³ÙŠØ©</span>`;
            }
            if (psych.addictions?.substances?.length > 0 || psych.addictions?.behaviors?.length > 0) {
                psychIndicators += `<span class="indicator-tag addiction">Ø¥Ø¯Ù…Ø§Ù†</span>`;
            }
            if (psych.traumas?.length > 0) {
                psychIndicators += `<span class="indicator-tag trauma">ØµØ¯Ù…Ø§Øª</span>`;
            }
            
            // Build themes section
            let themesHtml = '';
            if (significant.themes?.length > 0) {
                const themeNames = {
                    'trauma': 'Ø§Ù„ØµØ¯Ù…Ø§Øª',
                    'relationships': 'Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª',
                    'family': 'Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©',
                    'work': 'Ø§Ù„Ø¹Ù…Ù„',
                    'self_worth': 'Ù‚ÙŠÙ…Ø© Ø§Ù„Ø°Ø§Øª',
                    'addiction': 'Ø§Ù„Ø¥Ø¯Ù…Ø§Ù†',
                    'anxiety': 'Ø§Ù„Ù‚Ù„Ù‚',
                    'depression': 'Ø§Ù„Ø§ÙƒØªØ¦Ø§Ø¨'
                };
                themesHtml = significant.themes.map(t => 
                    `<span class="theme-tag">${themeNames[t] || t}</span>`
                ).join('');
            }
            
            // Build mood history
            let moodHtml = '';
            if (emotional.moodHistory?.length > 0) {
                const emotionNames = {
                    'anger': 'ğŸ˜  ØºØ¶Ø¨',
                    'sadness': 'ğŸ˜¢ Ø­Ø²Ù†',
                    'anxiety': 'ğŸ˜° Ù‚Ù„Ù‚',
                    'shame': 'ğŸ˜³ Ø®Ø¬Ù„',
                    'loneliness': 'ğŸ˜” ÙˆØ­Ø¯Ø©',
                    'hope': 'ğŸŒŸ Ø£Ù…Ù„',
                    'love': 'â¤ï¸ Ø­Ø¨',
                    'fear': 'ğŸ˜¨ Ø®ÙˆÙ'
                };
                const recentMoods = emotional.moodHistory.slice(-10);
                const moodCounts = {};
                recentMoods.forEach(m => {
                    m.emotions.forEach(e => {
                        moodCounts[e] = (moodCounts[e] || 0) + 1;
                    });
                });
                moodHtml = Object.entries(moodCounts)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 5)
                    .map(([e, c]) => `<span class="mood-tag">${emotionNames[e] || e} (${c})</span>`)
                    .join('');
            }
            
            // Build people section
            let peopleHtml = '';
            if (significant.people?.length > 0) {
                const relationNames = {
                    'mother': 'Ø§Ù„Ø£Ù…',
                    'father': 'Ø§Ù„Ø£Ø¨',
                    'brother': 'Ø£Ø®',
                    'sister': 'Ø£Ø®Øª',
                    'husband': 'Ø²ÙˆØ¬',
                    'wife': 'Ø²ÙˆØ¬Ø©',
                    'partner': 'Ø´Ø±ÙŠÙƒ',
                    'friend': 'ØµØ¯ÙŠÙ‚'
                };
                peopleHtml = significant.people.map(p => 
                    `<span class="people-tag">${relationNames[p.relation] || p.relation} (${p.mentions} Ø°ÙƒØ±)</span>`
                ).join('');
            }
            
            // Build insights section
            let insightsHtml = '';
            if (profile.aiObservations?.keyInsights?.length > 0) {
                insightsHtml = profile.aiObservations.keyInsights.slice(-5).map(i => 
                    `<div class="insight-item">ğŸ’¡ ${typeof i === 'object' ? i.text : i}</div>`
                ).join('');
            }
            
            // Build goals section  
            let goalsHtml = '';
            if (profile.goals?.inProgress?.length > 0) {
                goalsHtml = profile.goals.inProgress.map(g => 
                    `<div class="goal-item">ğŸ¯ ${typeof g === 'object' ? g.text : g}</div>`
                ).join('');
            }
            
            // Build completed goals
            let completedGoalsHtml = '';
            if (profile.goals?.completed?.length > 0) {
                completedGoalsHtml = profile.goals.completed.slice(-3).map(g => 
                    `<div class="goal-completed">âœ… ${typeof g === 'object' ? g.text : g}</div>`
                ).join('');
            }
            
            content.innerHTML = `
                <div class="profile-header">
                    <div class="profile-avatar">
                        <div class="avatar-eyes">
                            <div class="eye"></div>
                            <div class="eye"></div>
                        </div>
                    </div>
                    <h2 class="profile-name">${profile.user?.name || 'Ù…Ù„ÙÙƒ Ø§Ù„Ø´Ø®ØµÙŠ'}</h2>
                    <p class="profile-subtitle">ØªØ­Ù„ÙŠÙ„ Ù†ÙØ³ÙŠ Ù…Ø³ØªÙ…Ø± Ù…Ø¹ Ù†ÙØ³ÙŠ</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">${stats.totalMessages}</div>
                        <div class="stat-label">Ø±Ø³Ø§Ù„Ø©</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${stats.totalSessions}</div>
                        <div class="stat-label">Ø¬Ù„Ø³Ø©</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${stats.daysSinceStart}</div>
                        <div class="stat-label">ÙŠÙˆÙ… Ù…Ø¹Ø§Ù‹</div>
                    </div>
                </div>
                
                ${psychIndicators ? `
                    <h3 class="section-title">ğŸ” Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ù†ÙØ³ÙŠØ© Ø§Ù„Ù…ÙƒØªØ´ÙØ©</h3>
                    <div class="indicators-container">
                        ${psychIndicators}
                    </div>
                ` : ''}
                
                ${themesHtml ? `
                    <h3 class="section-title">ğŸ“Œ Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h3>
                    <div class="themes-container">
                        ${themesHtml}
                    </div>
                ` : ''}
                
                ${moodHtml ? `
                    <h3 class="section-title">ğŸ’­ Ø§Ù„Ù…Ø´Ø§Ø¹Ø± Ø§Ù„Ø£Ø®ÙŠØ±Ø©</h3>
                    <div class="moods-container">
                        ${moodHtml}
                    </div>
                ` : ''}
                
                ${peopleHtml ? `
                    <h3 class="section-title">ğŸ‘¥ Ø£Ø´Ø®Ø§Øµ Ù…Ù‡Ù…ÙˆÙ†</h3>
                    <div class="people-container">
                        ${peopleHtml}
                    </div>
                ` : ''}
                
                ${goalsHtml ? `
                    <h3 class="section-title">ğŸ¯ Ø£Ù‡Ø¯Ø§ÙÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h3>
                    <div class="goals-container">
                        ${goalsHtml}
                    </div>
                ` : ''}
                
                ${completedGoalsHtml ? `
                    <h3 class="section-title">âœ¨ Ø¥Ù†Ø¬Ø§Ø²Ø§Øª</h3>
                    <div class="completed-container">
                        ${completedGoalsHtml}
                    </div>
                ` : ''}
                
                ${insightsHtml ? `
                    <h3 class="section-title">ğŸ§  Ø±Ø¤Ù‰ ÙˆÙ…Ù„Ø§Ø­Ø¸Ø§Øª</h3>
                    <div class="insights-container">
                        ${insightsHtml}
                    </div>
                ` : ''}
                
                ${profile.weeklyReports?.length > 0 ? `
                    <h3 class="section-title">ğŸ“Š Ø¢Ø®Ø± ØªÙ‚Ø±ÙŠØ± Ø£Ø³Ø¨ÙˆØ¹ÙŠ</h3>
                    <div class="weekly-report">
                        <div class="report-header">
                            <span class="report-title">Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</span>
                            <span class="report-date">${new Date(profile.weeklyReports[0].date).toLocaleDateString('ar-EG')}</span>
                        </div>
                        <p class="report-content">${profile.weeklyReports[0].content}</p>
                    </div>
                ` : `
                    <div class="analysis-card">
                        <h4 class="analysis-title">ğŸ“Š Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</h4>
                        <p class="analysis-content">Ù„Ù… ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ø£Ø³Ø¨ÙˆØ¹ÙŠ Ø¨Ø¹Ø¯. Ø§Ø·Ù„Ø¨ ØªÙ‚Ø±ÙŠØ±Ø§Ù‹ Ù…Ù† Ø§Ù„Ø´Ø§Øª.</p>
                    </div>
                `}
                
                <h3 class="section-title">ğŸ¯ ØªØ®ØµØµØ§ØªÙŠ</h3>
                <div class="analysis-card">
                    <div class="trait-list">
                        <span class="trait-tag">Ø§Ù„ØµØ¯Ù…Ø§Øª Ø§Ù„Ù†ÙØ³ÙŠØ© (Gabor MatÃ©)</span>
                        <span class="trait-tag">Ø§Ù„Ø¥Ø³Ø§Ø¡Ø© Ø§Ù„Ù†Ø±Ø¬Ø³ÙŠØ© ÙˆØ§Ù„ØªØ±Ø§Ø¨Ø· Ø§Ù„ØµØ¯Ù…ÙŠ</span>
                        <span class="trait-tag">Ø§Ù„Ø¥Ø¯Ù…Ø§Ù†</span>
                        <span class="trait-tag">Ø§Ù„Ø¹Ù„Ø§Ø¬ Ø§Ù„Ø¬Ù†Ø³ÙŠ</span>
                        <span class="trait-tag">ADHD</span>
                    </div>
                </div>
                
                <h3 class="section-title">âš™ï¸ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</h3>
                <button class="action-btn" onclick="requestWeeklyReport(); showPage('chat');">
                    ğŸ“Š Ø·Ù„Ø¨ ØªÙ‚Ø±ÙŠØ± Ø£Ø³Ø¨ÙˆØ¹ÙŠ
                </button>
                <button class="action-btn" onclick="requestPersonalityAnalysis(); showPage('chat');">
                    ğŸ§  Ø·Ù„Ø¨ ØªØ­Ù„ÙŠÙ„ Ø´Ø®ØµÙŠØ©
                </button>
                <button class="action-btn" onclick="exportData()">
                    ğŸ“¤ ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§ØªÙŠ
                </button>
                <button class="action-btn danger" onclick="clearAllData()">
                    ğŸ—‘ï¸ Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </button>
            `;
        }
        
        function requestPersonalityAnalysis() {
            const input = document.getElementById('messageInput');
            input.value = 'Ø£Ø±ÙŠØ¯ ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ø´Ø®ØµÙŠØªÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…Ø­Ø§Ø¯Ø«Ø§ØªÙ†Ø§ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©';
            sendMessage();
        }

        // ===== INITIALIZATION =====
        window.onload = () => {
            // Preload voices
            speechSynthesis.getVoices();
            
            // Check login
            if (localStorage.getItem('nafsy_logged_in') === 'true') {
                document.getElementById('loginPage').classList.remove('active');
                document.getElementById('chatPage').classList.add('active');
                loadCurrentChat();
                renderResources();
                renderProfile();
            }
        };
    </script>
</body>
</html>
